<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 6 Analyzing temperature and precipitation change over time | Colonial-era landscape changes has led to grassland bird species declines over the last century</title>
  <meta name="description" content="Section 6 Analyzing temperature and precipitation change over time | Colonial-era landscape changes has led to grassland bird species declines over the last century" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 6 Analyzing temperature and precipitation change over time | Colonial-era landscape changes has led to grassland bird species declines over the last century" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="vjjan91/nilgiris-resurvey-project" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 6 Analyzing temperature and precipitation change over time | Colonial-era landscape changes has led to grassland bird species declines over the last century" />
  
  
  

<meta name="author" content="Vijay Ramesh" />
<meta name="author" content="VA Akshay" />
<meta name="author" content="Pratik Rajan Gupte" />
<meta name="author" content="Amrutha Rajan" />
<meta name="author" content="Chandrasekar Das" />
<meta name="author" content="Priyanka Hari Haran" />
<meta name="author" content="Ian Lockwood" />
<meta name="author" content="Ashwini Mohan" />
<meta name="author" content="Morgan W Tingley" />
<meta name="author" content="VV Robin" />
<meta name="author" content="Ruth S DeFries" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reconstructing-climate-data.html"/>
<link rel="next" href="land-cover-classification-and-change-detection.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#attribution"><i class="fa fa-check"></i><b>1.1</b> Attribution</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-access"><i class="fa fa-check"></i><b>1.2</b> Data access</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-processing"><i class="fa fa-check"></i><b>1.3</b> Data processing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prepare-climate-data-for-interpolation.html"><a href="prepare-climate-data-for-interpolation.html"><i class="fa fa-check"></i><b>2</b> Prepare Climate Data for Interpolation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="prepare-climate-data-for-interpolation.html"><a href="prepare-climate-data-for-interpolation.html#load-libraries"><i class="fa fa-check"></i><b>2.1</b> Load libraries</a></li>
<li class="chapter" data-level="2.2" data-path="prepare-climate-data-for-interpolation.html"><a href="prepare-climate-data-for-interpolation.html#prepare-climate-data"><i class="fa fa-check"></i><b>2.2</b> Prepare climate data</a></li>
<li class="chapter" data-level="2.3" data-path="prepare-climate-data-for-interpolation.html"><a href="prepare-climate-data-for-interpolation.html#summarise-by-month"><i class="fa fa-check"></i><b>2.3</b> Summarise by month</a></li>
<li class="chapter" data-level="2.4" data-path="prepare-climate-data-for-interpolation.html"><a href="prepare-climate-data-for-interpolation.html#prepare-for-spatial-data"><i class="fa fa-check"></i><b>2.4</b> Prepare for spatial data</a></li>
<li class="chapter" data-level="2.5" data-path="prepare-climate-data-for-interpolation.html"><a href="prepare-climate-data-for-interpolation.html#prepare-spatial-data"><i class="fa fa-check"></i><b>2.5</b> Prepare spatial data</a></li>
<li class="chapter" data-level="2.6" data-path="prepare-climate-data-for-interpolation.html"><a href="prepare-climate-data-for-interpolation.html#prepare-coastline-data"><i class="fa fa-check"></i><b>2.6</b> Prepare coastline data</a></li>
<li class="chapter" data-level="2.7" data-path="prepare-climate-data-for-interpolation.html"><a href="prepare-climate-data-for-interpolation.html#resample-raster-to-600m"><i class="fa fa-check"></i><b>2.7</b> Resample raster to 600m</a></li>
<li class="chapter" data-level="2.8" data-path="prepare-climate-data-for-interpolation.html"><a href="prepare-climate-data-for-interpolation.html#link-predictors-to-climate-data"><i class="fa fa-check"></i><b>2.8</b> Link predictors to climate data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html"><i class="fa fa-check"></i><b>3</b> Validating semi-spatial GAMs for climate</a>
<ul>
<li class="chapter" data-level="3.1" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#load-libraries-1"><i class="fa fa-check"></i><b>3.1</b> Load libraries</a></li>
<li class="chapter" data-level="3.2" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#load-data-prepared-for-the-gam-and-the-stack-predictor-raster."><i class="fa fa-check"></i><b>3.2</b> Load data prepared for the GAM, and the stack predictor raster.</a></li>
<li class="chapter" data-level="3.3" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#prepare-data-covariates-and-raster"><i class="fa fa-check"></i><b>3.3</b> Prepare data covariates and raster</a></li>
<li class="chapter" data-level="3.4" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#pivot-longer-to-separate-by-variable."><i class="fa fa-check"></i><b>3.4</b> Pivot longer to separate by variable.</a></li>
<li class="chapter" data-level="3.5" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#split-the-data-by-variable."><i class="fa fa-check"></i><b>3.5</b> Split the data by variable.</a></li>
<li class="chapter" data-level="3.6" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#fit-candidate-models"><i class="fa fa-check"></i><b>3.6</b> Fit candidate models</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#save-model-data."><i class="fa fa-check"></i><b>3.6.1</b> Save model data.</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#predict-over-static-environment"><i class="fa fa-check"></i><b>3.7</b> Predict over static environment</a></li>
<li class="chapter" data-level="3.8" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#average-predictions-over-1970-to-2010."><i class="fa fa-check"></i><b>3.8</b> Average predictions over 1970 to 2010.</a></li>
<li class="chapter" data-level="3.9" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#get-bioclim-data"><i class="fa fa-check"></i><b>3.9</b> Get BIOCLIM data</a></li>
<li class="chapter" data-level="3.10" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#get-precipitation-data"><i class="fa fa-check"></i><b>3.10</b> Get precipitation data</a></li>
<li class="chapter" data-level="3.11" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#get-sample-coordinates"><i class="fa fa-check"></i><b>3.11</b> Get sample coordinates</a></li>
<li class="chapter" data-level="3.12" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#compare-bioclim-and-model-predictions"><i class="fa fa-check"></i><b>3.12</b> Compare BIOCLIM and model predictions</a></li>
<li class="chapter" data-level="3.13" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#link-with-gam-predictions"><i class="fa fa-check"></i><b>3.13</b> Link with GAM predictions</a></li>
<li class="chapter" data-level="3.14" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#get-gam-predictions-at-chelsa-sample-locations."><i class="fa fa-check"></i><b>3.14</b> Get GAM predictions at chelsa sample locations.</a></li>
<li class="chapter" data-level="3.15" data-path="validating-semi-spatial-gams-for-climate.html"><a href="validating-semi-spatial-gams-for-climate.html#gam-predictions-at-survey-sites"><i class="fa fa-check"></i><b>3.15</b> GAM predictions at survey sites</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html"><i class="fa fa-check"></i><b>4</b> GAM error in predicting climate</a>
<ul>
<li class="chapter" data-level="4.1" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html#load-libraries-2"><i class="fa fa-check"></i><b>4.1</b> Load libraries</a></li>
<li class="chapter" data-level="4.2" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html#load-data"><i class="fa fa-check"></i><b>4.2</b> Load data</a></li>
<li class="chapter" data-level="4.3" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html#plot-model-error"><i class="fa fa-check"></i><b>4.3</b> Plot model error</a></li>
<li class="chapter" data-level="4.4" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html#compare-climate-predictions-at-survey-sites"><i class="fa fa-check"></i><b>4.4</b> Compare climate predictions at survey sites</a></li>
<li class="chapter" data-level="4.5" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html#plot-gam-prediction-residuals"><i class="fa fa-check"></i><b>4.5</b> Plot GAM prediction residuals</a></li>
<li class="chapter" data-level="4.6" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html#load-processed-bioclim-data"><i class="fa fa-check"></i><b>4.6</b> Load processed BIOCLIM data</a></li>
<li class="chapter" data-level="4.7" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html#get-prediction-as-fraction-of-bioclim-layers"><i class="fa fa-check"></i><b>4.7</b> Get prediction as fraction of BIOCLIM layers</a></li>
<li class="chapter" data-level="4.8" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html#temperature-fractions"><i class="fa fa-check"></i><b>4.8</b> Temperature fractions</a></li>
<li class="chapter" data-level="4.9" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html#precipitation-fractions"><i class="fa fa-check"></i><b>4.9</b> Precipitation fractions</a></li>
<li class="chapter" data-level="4.10" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html#save-climate-correction-layers"><i class="fa fa-check"></i><b>4.10</b> Save climate correction layers</a></li>
<li class="chapter" data-level="4.11" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html#seasonal-mean-temperature-correction-layer"><i class="fa fa-check"></i><b>4.11</b> Seasonal mean temperature correction layer</a></li>
<li class="chapter" data-level="4.12" data-path="gam-error-in-predicting-climate.html"><a href="gam-error-in-predicting-climate.html#seasonal-total-rainfall-correction-layer"><i class="fa fa-check"></i><b>4.12</b> Seasonal total rainfall correction layer</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html"><i class="fa fa-check"></i><b>5</b> Reconstructing climate data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html#load-libraries-3"><i class="fa fa-check"></i><b>5.1</b> Load libraries</a></li>
<li class="chapter" data-level="5.2" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html#load-data-prepared-for-the-gam-and-the-stack-predictor-raster.-1"><i class="fa fa-check"></i><b>5.2</b> Load data prepared for the GAM, and the stack predictor raster.</a></li>
<li class="chapter" data-level="5.3" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html#prepare-data-covariates-and-raster."><i class="fa fa-check"></i><b>5.3</b> Prepare data covariates and raster.</a></li>
<li class="chapter" data-level="5.4" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html#pivot-longer-to-separate-by-variable.-1"><i class="fa fa-check"></i><b>5.4</b> Pivot longer to separate by variable.</a></li>
<li class="chapter" data-level="5.5" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html#split-data-by-variable-season-and-year-bin"><i class="fa fa-check"></i><b>5.5</b> Split data by variable, season, and year bin</a></li>
<li class="chapter" data-level="5.6" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html#fit-chosen-gams"><i class="fa fa-check"></i><b>5.6</b> Fit chosen GAMs</a></li>
<li class="chapter" data-level="5.7" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html#assign-formula-to-variable."><i class="fa fa-check"></i><b>5.7</b> Assign formula to variable.</a></li>
<li class="chapter" data-level="5.8" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html#fit-gams"><i class="fa fa-check"></i><b>5.8</b> Fit GAMs</a></li>
<li class="chapter" data-level="5.9" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html#save-model-data.-1"><i class="fa fa-check"></i><b>5.9</b> Save model data.</a></li>
<li class="chapter" data-level="5.10" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html#predict-over-static-environment-1"><i class="fa fa-check"></i><b>5.10</b> Predict over static environment</a></li>
<li class="chapter" data-level="5.11" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html#apply-correction-layers"><i class="fa fa-check"></i><b>5.11</b> Apply correction layers</a></li>
<li class="chapter" data-level="5.12" data-path="reconstructing-climate-data.html"><a href="reconstructing-climate-data.html#link-correction-layers-with-predictions"><i class="fa fa-check"></i><b>5.12</b> Link correction layers with predictions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html"><i class="fa fa-check"></i><b>6</b> Analyzing temperature and precipitation change over time</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#load-necessary-libraries"><i class="fa fa-check"></i><b>6.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="6.2" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#plot-change-in-climate-as-percentages."><i class="fa fa-check"></i><b>6.2</b> Plot change in climate as percentages.</a></li>
<li class="chapter" data-level="6.3" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#load-list-of-resurvey-locationshistorical-sites-of-occurrence"><i class="fa fa-check"></i><b>6.3</b> Load list of resurvey locations/historical sites of occurrence</a></li>
<li class="chapter" data-level="6.4" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#load-the-climate-rasters"><i class="fa fa-check"></i><b>6.4</b> Load the climate rasters</a></li>
<li class="chapter" data-level="6.5" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#combine-site-climate-and-terrain-data"><i class="fa fa-check"></i><b>6.5</b> Combine site climate and terrain data</a></li>
<li class="chapter" data-level="6.6" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#plot-all-reconstructed-climate-over-time-colouring-by-elevation-and-grouping-by-site.-each-line-represents-one-modern-site-code."><i class="fa fa-check"></i><b>6.6</b> Plot all reconstructed climate over time colouring by elevation and grouping by site. Each line represents one modern site code.</a></li>
<li class="chapter" data-level="6.7" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#test-for-climate-change-over-time"><i class="fa fa-check"></i><b>6.7</b> Test for climate change over time</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html"><i class="fa fa-check"></i><b>7</b> Land cover classification and change detection</a>
<ul>
<li class="chapter" data-level="7.1" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#load-necessary-libraries-1"><i class="fa fa-check"></i><b>7.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="7.2" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#processing-digitized-shapefiles-from-the-1848-map"><i class="fa fa-check"></i><b>7.2</b> Processing digitized shapefiles from the 1848 map</a></li>
<li class="chapter" data-level="7.3" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#rasterization-of-the-1848-shapefiles"><i class="fa fa-check"></i><b>7.3</b> Rasterization of the 1848 shapefiles</a></li>
<li class="chapter" data-level="7.4" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#load-the-2018-satellite-image"><i class="fa fa-check"></i><b>7.4</b> Load the 2018 satellite image</a></li>
<li class="chapter" data-level="7.5" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#subsume-plantations-into-one-category-for-2018"><i class="fa fa-check"></i><b>7.5</b> Subsume plantations into one category for 2018</a></li>
<li class="chapter" data-level="7.6" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#write-the-shapefiles-and-rasters-to-file"><i class="fa fa-check"></i><b>7.6</b> Write the shapefiles and rasters to file</a></li>
<li class="chapter" data-level="7.7" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#area-wise-comparisons-of-land-cover-change"><i class="fa fa-check"></i><b>7.7</b> Area-wise comparisons of land cover change</a></li>
<li class="chapter" data-level="7.8" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#barplots-of-land-cover-change"><i class="fa fa-check"></i><b>7.8</b> Barplots of land cover change</a></li>
<li class="chapter" data-level="7.9" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#validating-the-2018-sentinel-2-classification"><i class="fa fa-check"></i><b>7.9</b> Validating the 2018 Sentinel-2 classification</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html"><i class="fa fa-check"></i><b>8</b> Grassland contractions &amp; forest expansions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#load-necessary-libraries-2"><i class="fa fa-check"></i><b>8.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="8.2" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#load-processed-land-cover-rasters"><i class="fa fa-check"></i><b>8.2</b> Load processed land cover rasters</a></li>
<li class="chapter" data-level="8.3" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#visualize-forests-across-the-two-time-periods"><i class="fa fa-check"></i><b>8.3</b> Visualize forests across the two time periods</a></li>
<li class="chapter" data-level="8.4" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#visualize-grassland-area-across-the-two-time-periods"><i class="fa fa-check"></i><b>8.4</b> Visualize grassland area across the two time periods</a></li>
<li class="chapter" data-level="8.5" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#comparing-if-forests-have-increased-in-locations-where-grasslands-were-formerly-found"><i class="fa fa-check"></i><b>8.5</b> Comparing if forests have increased in locations where grasslands were formerly found?</a></li>
<li class="chapter" data-level="8.6" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#have-forests-expanded-across-elevations"><i class="fa fa-check"></i><b>8.6</b> Have forests expanded across elevations?</a></li>
<li class="chapter" data-level="8.7" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#how-do-grassland-patches-vary-by-elevation-across-time-periods"><i class="fa fa-check"></i><b>8.7</b> How do grassland patches vary by elevation across time periods?</a></li>
<li class="chapter" data-level="8.8" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#comparing-if-plantations-have-increased-in-locations-where-grasslands-were-formerly-found"><i class="fa fa-check"></i><b>8.8</b> Comparing if plantations have increased in locations where grasslands were formerly found?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html"><i class="fa fa-check"></i><b>9</b> Visualizing time series of change</a>
<ul>
<li class="chapter" data-level="9.1" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#load-necessary-libraries-3"><i class="fa fa-check"></i><b>9.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="9.2" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#load-processed-land-cover-rasters-1"><i class="fa fa-check"></i><b>9.2</b> Load processed land cover rasters</a></li>
<li class="chapter" data-level="9.3" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#loading-data-from-the-1910-map"><i class="fa fa-check"></i><b>9.3</b> Loading data from the 1910 map</a></li>
<li class="chapter" data-level="9.4" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#rasterizing-of-the-1910-data"><i class="fa fa-check"></i><b>9.4</b> Rasterizing of the 1910 data</a></li>
<li class="chapter" data-level="9.5" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#loading-the-1973-and-1995-data"><i class="fa fa-check"></i><b>9.5</b> Loading the 1973 and 1995 data</a></li>
<li class="chapter" data-level="9.6" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#rasterization-of-the-1973-and-1995-data"><i class="fa fa-check"></i><b>9.6</b> Rasterization of the 1973 and 1995 data</a></li>
<li class="chapter" data-level="9.7" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#visualization-of-landscape-change-over-time"><i class="fa fa-check"></i><b>9.7</b> Visualization of landscape change over time</a></li>
<li class="chapter" data-level="9.8" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#subsume-plantations-into-one-category-for-1973-1995-and-2018"><i class="fa fa-check"></i><b>9.8</b> Subsume plantations into one category for 1973, 1995, and 2018</a></li>
<li class="chapter" data-level="9.9" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#creating-smaller-regions-of-interest-for-comparison"><i class="fa fa-check"></i><b>9.9</b> Creating smaller regions of interest for comparison</a></li>
<li class="chapter" data-level="9.10" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#comparisons-only-above-1400-meters-in-elevation"><i class="fa fa-check"></i><b>9.10</b> Comparisons only above 1400 meters in elevation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html"><i class="fa fa-check"></i><b>10</b> Exploratory analysis of occurrence data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html#load-necessary-libraries-4"><i class="fa fa-check"></i><b>10.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="10.2" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html#load-the-historical-occurrence-data-and-explore-patterns"><i class="fa fa-check"></i><b>10.2</b> Load the historical occurrence data and explore patterns</a></li>
<li class="chapter" data-level="10.3" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html#examining-historical-data-by-locality"><i class="fa fa-check"></i><b>10.3</b> Examining historical data by locality</a></li>
<li class="chapter" data-level="10.4" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html#visualizations-of-historical-data"><i class="fa fa-check"></i><b>10.4</b> Visualizations of historical data</a></li>
<li class="chapter" data-level="10.5" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html#examining-species-specific-counts-by-locality"><i class="fa fa-check"></i><b>10.5</b> Examining species specific counts by locality</a></li>
<li class="chapter" data-level="10.6" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html#load-modern-occurrence-data-and-explore-patterns"><i class="fa fa-check"></i><b>10.6</b> Load modern occurrence data and explore patterns</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html"><i class="fa fa-check"></i><b>11</b> Species relative abundances over time</a>
<ul>
<li class="chapter" data-level="11.1" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#load-necessary-libraries-5"><i class="fa fa-check"></i><b>11.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="11.2" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#load-list-of-resurvey-locations"><i class="fa fa-check"></i><b>11.2</b> Load list of resurvey locations</a></li>
<li class="chapter" data-level="11.3" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#for-the-historical-occurrence-data-we-will-choose-data-from-two-time-periods-1850-1900-1900-1950."><i class="fa fa-check"></i><b>11.3</b> For the historical occurrence data, we will choose data from two time periods: 1850-1900 &amp; 1900-1950.</a></li>
<li class="chapter" data-level="11.4" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#load-the-modern-occurrence-data"><i class="fa fa-check"></i><b>11.4</b> Load the modern occurrence data</a></li>
<li class="chapter" data-level="11.5" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#calculate-dirichlet-distributions-of-relative-abundance"><i class="fa fa-check"></i><b>11.5</b> Calculate dirichlet distributions of relative abundance</a></li>
<li class="chapter" data-level="11.6" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#calibrating-historical-data-to-modern-survey-data-for-relative-abundance-calculations"><i class="fa fa-check"></i><b>11.6</b> Calibrating historical data to modern survey data for relative abundance calculations</a></li>
<li class="chapter" data-level="11.7" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#boxplot-visualization-of-overall-relative-abundance-across-timeperiods"><i class="fa fa-check"></i><b>11.7</b> Boxplot visualization of overall relative abundance across timeperiods</a></li>
<li class="chapter" data-level="11.8" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#species-relative-abundances-at-the-site-level"><i class="fa fa-check"></i><b>11.8</b> Species relative abundances at the site-level</a></li>
<li class="chapter" data-level="11.9" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#visualizing-differences-in-relative-abundance-over-time-at-the-site-level"><i class="fa fa-check"></i><b>11.9</b> Visualizing differences in relative abundance over time at the site level</a></li>
<li class="chapter" data-level="11.10" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#writing-results-to-file"><i class="fa fa-check"></i><b>11.10</b> Writing results to file</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><i class="fa fa-check"></i><b>12</b> Examining changes in relative abundance over time as a function of species habitat affiliation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#load-necessary-libraries-6"><i class="fa fa-check"></i><b>12.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="12.2" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#load-data-on-species-relative-abundances"><i class="fa fa-check"></i><b>12.2</b> Load data on species relative abundances</a></li>
<li class="chapter" data-level="12.3" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#load-species-trait-data"><i class="fa fa-check"></i><b>12.3</b> Load species trait data</a></li>
<li class="chapter" data-level="12.4" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#visualizing-relative-abundance-change-by-species-across-time-periods-for-grassland-bird-species"><i class="fa fa-check"></i><b>12.4</b> Visualizing relative abundance change by species across time periods for grassland bird species</a></li>
<li class="chapter" data-level="12.5" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#rank-abundance-plots-of-relative-abundance-by-species-trait-across-time-periods"><i class="fa fa-check"></i><b>12.5</b> Rank abundance plots of relative abundance by species trait across time periods</a></li>
<li class="chapter" data-level="12.6" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#are-there-significant-decreases-in-relative-abundance-by-time-periods-across-habitat-affiliations"><i class="fa fa-check"></i><b>12.6</b> Are there significant decreases in relative abundance by time periods across habitat affiliations?</a></li>
<li class="chapter" data-level="12.7" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#forest-birds"><i class="fa fa-check"></i><b>12.7</b> Forest birds</a></li>
<li class="chapter" data-level="12.8" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#grassland-birds"><i class="fa fa-check"></i><b>12.8</b> Grassland birds</a></li>
<li class="chapter" data-level="12.9" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#generalist-birds"><i class="fa fa-check"></i><b>12.9</b> Generalist birds</a></li>
<li class="chapter" data-level="12.10" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#creating-a-combined-figure-for-the-above-three-models"><i class="fa fa-check"></i><b>12.10</b> Creating a combined figure for the above three models</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Colonial-era landscape changes has led to grassland bird species declines over the last century</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analyzing-temperature-and-precipitation-change-over-time" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Section 6</span> Analyzing temperature and precipitation change over time<a href="analyzing-temperature-and-precipitation-change-over-time.html#analyzing-temperature-and-precipitation-change-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this script, we will process the reconstructed climate data and analyze trends in climate over time</p>
<div id="load-necessary-libraries" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Load necessary libraries<a href="analyzing-temperature-and-precipitation-change-over-time.html#load-necessary-libraries" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-1" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb63-2"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-2" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb63-3"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-3" tabindex="-1"></a><span class="fu">library</span>(stringi)</span>
<span id="cb63-4"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-4" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb63-5"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-5" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb63-6"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-6" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb63-7"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-7" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb63-8"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-8" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb63-9"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-9" tabindex="-1"></a></span>
<span id="cb63-10"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-10" tabindex="-1"></a><span class="co"># for plotting</span></span>
<span id="cb63-11"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-11" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb63-12"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-12" tabindex="-1"></a><span class="fu">library</span>(colorspace)</span>
<span id="cb63-13"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-13" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb63-14"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-14" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb63-15"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-15" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb63-16"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-16" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb63-17"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-17" tabindex="-1"></a></span>
<span id="cb63-18"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-18" tabindex="-1"></a><span class="co"># for GLMMS</span></span>
<span id="cb63-19"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb63-19" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-1" tabindex="-1"></a><span class="co"># load nilgiris</span></span>
<span id="cb64-2"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-2" tabindex="-1"></a>hills <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/landcover/Nil_Ana_Pal.shp&quot;</span>)</span>
<span id="cb64-3"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-3" tabindex="-1"></a></span>
<span id="cb64-4"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-4" tabindex="-1"></a><span class="co"># get reconstructions</span></span>
<span id="cb64-5"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-5" tabindex="-1"></a>climate_reconstructed <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb64-6"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-6" tabindex="-1"></a>  <span class="st">&quot;results/climate&quot;</span>,</span>
<span id="cb64-7"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-7" tabindex="-1"></a>  <span class="at">pattern =</span> <span class="st">&quot;raster_reconstructed&quot;</span>,</span>
<span id="cb64-8"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-8" tabindex="-1"></a>  <span class="at">full.names =</span> T</span>
<span id="cb64-9"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-9" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb64-10"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-10" tabindex="-1"></a>  <span class="fu">lapply</span>(rast)</span>
<span id="cb64-11"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-11" tabindex="-1"></a></span>
<span id="cb64-12"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-12" tabindex="-1"></a><span class="co"># get differences with respect to first reconstruction</span></span>
<span id="cb64-13"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-13" tabindex="-1"></a>climate_change <span class="ot">&lt;-</span> <span class="fu">lapply</span>(climate_reconstructed, <span class="cf">function</span>(le) {</span>
<span id="cb64-14"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-14" tabindex="-1"></a>  le <span class="ot">&lt;-</span> le <span class="sc">/</span> le[[<span class="dv">1</span>]]</span>
<span id="cb64-15"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-15" tabindex="-1"></a>  le <span class="ot">&lt;-</span> le[[<span class="sc">-</span><span class="dv">1</span>]]</span>
<span id="cb64-16"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-16" tabindex="-1"></a>  le <span class="ot">&lt;-</span> le <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb64-17"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-17" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">crop</span>(</span>
<span id="cb64-18"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-18" tabindex="-1"></a>    le, <span class="fu">vect</span>(hills)</span>
<span id="cb64-19"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-19" tabindex="-1"></a>  )</span>
<span id="cb64-20"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb64-20" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="plot-change-in-climate-as-percentages." class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Plot change in climate as percentages.<a href="analyzing-temperature-and-precipitation-change-over-time.html#plot-change-in-climate-as-percentages." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-1" tabindex="-1"></a>ppt_dry_change <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(climate_change[[<span class="dv">1</span>]]) <span class="sc">+</span></span>
<span id="cb65-2"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-2" tabindex="-1"></a>  <span class="fu">tm_raster</span>(</span>
<span id="cb65-3"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-3" tabindex="-1"></a>    <span class="at">palette =</span> colorspace<span class="sc">::</span><span class="fu">diverging_hcl</span>(</span>
<span id="cb65-4"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-4" tabindex="-1"></a>      <span class="dv">31</span>,</span>
<span id="cb65-5"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-5" tabindex="-1"></a>      <span class="at">palette =</span> <span class="st">&quot;Blue-Yellow&quot;</span>,</span>
<span id="cb65-6"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-6" tabindex="-1"></a>      <span class="at">rev =</span> T</span>
<span id="cb65-7"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-7" tabindex="-1"></a>    ),</span>
<span id="cb65-8"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-8" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb65-9"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;% difference, dry season ppt.&quot;</span>,</span>
<span id="cb65-10"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-10" tabindex="-1"></a>    <span class="at">legend.is.portrait =</span> F</span>
<span id="cb65-11"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb65-12"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-12" tabindex="-1"></a>  <span class="fu">tm_shape</span>(hills) <span class="sc">+</span></span>
<span id="cb65-13"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-13" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb65-14"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-14" tabindex="-1"></a>  <span class="fu">tm_legend</span>(</span>
<span id="cb65-15"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-15" tabindex="-1"></a>    <span class="at">legend.outside =</span> T,</span>
<span id="cb65-16"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-16" tabindex="-1"></a>    <span class="at">legend.outside.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb65-17"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-17" tabindex="-1"></a>    <span class="at">legend.outside.size =</span> .<span class="dv">1</span></span>
<span id="cb65-18"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-18" tabindex="-1"></a>  )</span>
<span id="cb65-19"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-19" tabindex="-1"></a></span>
<span id="cb65-20"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-20" tabindex="-1"></a><span class="fu">tmap_save</span>(</span>
<span id="cb65-21"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-21" tabindex="-1"></a>  ppt_dry_change,</span>
<span id="cb65-22"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-22" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">&quot;figs/fig_ppt_dry_change.png&quot;</span></span>
<span id="cb65-23"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb65-23" tabindex="-1"></a>)</span></code></pre></div>
<div class="float">
<img src="figs/fig_ppt_dry_change.png" alt="Decadal changes in dry season precipitation over the last century" />
<div class="figcaption">Decadal changes in dry season precipitation over the last century</div>
</div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-1" tabindex="-1"></a>ppt_wet_change <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(climate_change[[<span class="dv">2</span>]]) <span class="sc">+</span></span>
<span id="cb66-2"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-2" tabindex="-1"></a>  <span class="fu">tm_raster</span>(</span>
<span id="cb66-3"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-3" tabindex="-1"></a>    <span class="at">palette =</span> colorspace<span class="sc">::</span><span class="fu">diverging_hcl</span>(</span>
<span id="cb66-4"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-4" tabindex="-1"></a>      <span class="dv">31</span>,</span>
<span id="cb66-5"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-5" tabindex="-1"></a>      <span class="at">palette =</span> <span class="st">&quot;Blue-Yellow&quot;</span>,</span>
<span id="cb66-6"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-6" tabindex="-1"></a>      <span class="at">rev =</span> T</span>
<span id="cb66-7"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-7" tabindex="-1"></a>    ),</span>
<span id="cb66-8"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-8" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb66-9"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;% difference, wet season ppt.&quot;</span>,</span>
<span id="cb66-10"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-10" tabindex="-1"></a>    <span class="at">legend.is.portrait =</span> F</span>
<span id="cb66-11"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-12"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-12" tabindex="-1"></a>  <span class="fu">tm_shape</span>(hills) <span class="sc">+</span></span>
<span id="cb66-13"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-13" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb66-14"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-14" tabindex="-1"></a>  <span class="fu">tm_legend</span>(</span>
<span id="cb66-15"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-15" tabindex="-1"></a>    <span class="at">legend.outside =</span> T,</span>
<span id="cb66-16"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-16" tabindex="-1"></a>    <span class="at">legend.outside.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb66-17"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-17" tabindex="-1"></a>    <span class="at">legend.outside.size =</span> .<span class="dv">1</span></span>
<span id="cb66-18"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-18" tabindex="-1"></a>  )</span>
<span id="cb66-19"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-19" tabindex="-1"></a></span>
<span id="cb66-20"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-20" tabindex="-1"></a><span class="fu">tmap_save</span>(</span>
<span id="cb66-21"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-21" tabindex="-1"></a>  ppt_wet_change,</span>
<span id="cb66-22"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-22" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">&quot;figs/fig_ppt_wet_change.png&quot;</span></span>
<span id="cb66-23"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb66-23" tabindex="-1"></a>)</span></code></pre></div>
<div class="float">
<img src="figs/fig_ppt_wet_change.png" alt="Decadal changes in rainy season precipitation over the last century" />
<div class="figcaption">Decadal changes in rainy season precipitation over the last century</div>
</div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-1" tabindex="-1"></a>temp_dry_change <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(climate_change[[<span class="dv">3</span>]]) <span class="sc">+</span></span>
<span id="cb67-2"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-2" tabindex="-1"></a>  <span class="fu">tm_raster</span>(</span>
<span id="cb67-3"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-3" tabindex="-1"></a>    <span class="at">palette =</span> colorspace<span class="sc">::</span><span class="fu">diverging_hcl</span>(</span>
<span id="cb67-4"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-4" tabindex="-1"></a>      <span class="dv">31</span>,</span>
<span id="cb67-5"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-5" tabindex="-1"></a>      <span class="at">rev =</span> F</span>
<span id="cb67-6"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-6" tabindex="-1"></a>    ),</span>
<span id="cb67-7"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-7" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb67-8"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;% difference, dry season temp.&quot;</span>,</span>
<span id="cb67-9"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-9" tabindex="-1"></a>    <span class="at">legend.is.portrait =</span> F</span>
<span id="cb67-10"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb67-11"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-11" tabindex="-1"></a>  <span class="fu">tm_shape</span>(hills) <span class="sc">+</span></span>
<span id="cb67-12"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-12" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb67-13"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-13" tabindex="-1"></a>  <span class="fu">tm_legend</span>(</span>
<span id="cb67-14"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-14" tabindex="-1"></a>    <span class="at">legend.outside =</span> T,</span>
<span id="cb67-15"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-15" tabindex="-1"></a>    <span class="at">legend.outside.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb67-16"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-16" tabindex="-1"></a>    <span class="at">legend.outside.size =</span> .<span class="dv">1</span></span>
<span id="cb67-17"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-17" tabindex="-1"></a>  )</span>
<span id="cb67-18"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-18" tabindex="-1"></a></span>
<span id="cb67-19"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-19" tabindex="-1"></a><span class="fu">tmap_save</span>(</span>
<span id="cb67-20"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-20" tabindex="-1"></a>  temp_dry_change,</span>
<span id="cb67-21"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-21" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">&quot;figs/fig_temp_dry_change.png&quot;</span></span>
<span id="cb67-22"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb67-22" tabindex="-1"></a>)</span></code></pre></div>
<div class="float">
<img src="figs/fig_temp_dry_change.png" alt="Decadal change in dry season temperatures over the last century" />
<div class="figcaption">Decadal change in dry season temperatures over the last century</div>
</div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-1" tabindex="-1"></a>temp_wet_change <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(climate_change[[<span class="dv">4</span>]]) <span class="sc">+</span></span>
<span id="cb68-2"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-2" tabindex="-1"></a>  <span class="fu">tm_raster</span>(</span>
<span id="cb68-3"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-3" tabindex="-1"></a>    <span class="at">palette =</span> colorspace<span class="sc">::</span><span class="fu">diverging_hcl</span>(</span>
<span id="cb68-4"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-4" tabindex="-1"></a>      <span class="dv">31</span>,</span>
<span id="cb68-5"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-5" tabindex="-1"></a>      <span class="at">rev =</span> F</span>
<span id="cb68-6"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-6" tabindex="-1"></a>    ),</span>
<span id="cb68-7"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-7" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">&quot;cont&quot;</span>, <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb68-8"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;% difference, wet season temp.&quot;</span>,</span>
<span id="cb68-9"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-9" tabindex="-1"></a>    <span class="at">legend.is.portrait =</span> F</span>
<span id="cb68-10"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb68-11"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-11" tabindex="-1"></a>  <span class="fu">tm_shape</span>(hills) <span class="sc">+</span></span>
<span id="cb68-12"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-12" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb68-13"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-13" tabindex="-1"></a>  <span class="fu">tm_legend</span>(</span>
<span id="cb68-14"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-14" tabindex="-1"></a>    <span class="at">legend.outside =</span> T,</span>
<span id="cb68-15"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-15" tabindex="-1"></a>    <span class="at">legend.outside.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb68-16"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-16" tabindex="-1"></a>    <span class="at">legend.outside.size =</span> .<span class="dv">1</span></span>
<span id="cb68-17"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-17" tabindex="-1"></a>  )</span>
<span id="cb68-18"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-18" tabindex="-1"></a></span>
<span id="cb68-19"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-19" tabindex="-1"></a><span class="fu">tmap_save</span>(</span>
<span id="cb68-20"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-20" tabindex="-1"></a>  temp_wet_change,</span>
<span id="cb68-21"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-21" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">&quot;figs/fig_temp_wet_change.png&quot;</span></span>
<span id="cb68-22"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb68-22" tabindex="-1"></a>)</span></code></pre></div>
<div class="float">
<img src="figs/fig_temp_wet_change.png" alt="Decadal change in wet season temperatures over the last century" />
<div class="figcaption">Decadal change in wet season temperatures over the last century</div>
</div>
</div>
<div id="load-list-of-resurvey-locationshistorical-sites-of-occurrence" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Load list of resurvey locations/historical sites of occurrence<a href="analyzing-temperature-and-precipitation-change-over-time.html#load-list-of-resurvey-locationshistorical-sites-of-occurrence" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-1" tabindex="-1"></a><span class="co"># load list of resurvey locations and add elevation as a variable</span></span>
<span id="cb69-2"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-2" tabindex="-1"></a><span class="co"># remove the modern resurvey locations only (ie. ASFQ)</span></span>
<span id="cb69-3"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-3" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/list-of-resurvey-locations.csv&quot;</span>)</span>
<span id="cb69-4"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-4" tabindex="-1"></a></span>
<span id="cb69-5"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-5" tabindex="-1"></a><span class="co"># set missing historical site code to NA</span></span>
<span id="cb69-6"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-6" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">mutate</span>(sites,</span>
<span id="cb69-7"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-7" tabindex="-1"></a>  <span class="at">historical_site_code =</span> <span class="fu">if_else</span>(</span>
<span id="cb69-8"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-8" tabindex="-1"></a>    historical_site_code <span class="sc">==</span> <span class="st">&quot;&quot;</span>, <span class="cn">NA_character_</span>, historical_site_code</span>
<span id="cb69-9"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-9" tabindex="-1"></a>  ),</span>
<span id="cb69-10"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-10" tabindex="-1"></a>  <span class="at">site_name =</span> <span class="fu">if_else</span>(</span>
<span id="cb69-11"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-11" tabindex="-1"></a>    site_name <span class="sc">==</span> <span class="st">&quot;&quot;</span>, <span class="cn">NA_character_</span>, site_name</span>
<span id="cb69-12"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-12" tabindex="-1"></a>  )</span>
<span id="cb69-13"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-13" tabindex="-1"></a>)</span>
<span id="cb69-14"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-14" tabindex="-1"></a></span>
<span id="cb69-15"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-15" tabindex="-1"></a><span class="co"># remove sites with historical site code missing</span></span>
<span id="cb69-16"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-16" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">filter</span>(sites, <span class="sc">!</span><span class="fu">is.na</span>(historical_site_code))</span>
<span id="cb69-17"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-17" tabindex="-1"></a></span>
<span id="cb69-18"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-18" tabindex="-1"></a><span class="co"># convert to sf object and transform</span></span>
<span id="cb69-19"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-19" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(sites, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb69-20"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-20" tabindex="-1"></a>  <span class="st">`</span><span class="at">st_crs&lt;-</span><span class="st">`</span>(<span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-21"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-21" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">32643</span>)</span>
<span id="cb69-22"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-22" tabindex="-1"></a></span>
<span id="cb69-23"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-23" tabindex="-1"></a><span class="co"># add an outline of the nilgiris shapefile (contains areas below 1400 m)</span></span>
<span id="cb69-24"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-24" tabindex="-1"></a>nil <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/landcover/Nil_Ana_Pal.shp&quot;</span>)</span>
<span id="cb69-25"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-25" tabindex="-1"></a>nil <span class="ot">&lt;-</span> nil[<span class="dv">2</span>, ]</span>
<span id="cb69-26"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-26" tabindex="-1"></a>nil <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(nil, <span class="dv">32643</span>)</span>
<span id="cb69-27"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-27" tabindex="-1"></a>buffer <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(nil, <span class="fl">3e4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-28"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-28" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="dv">4326</span>)</span>
<span id="cb69-29"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-29" tabindex="-1"></a></span>
<span id="cb69-30"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-30" tabindex="-1"></a><span class="co"># add the elevation raster</span></span>
<span id="cb69-31"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-31" tabindex="-1"></a>alt <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">&quot;data/elevation/alt/&quot;</span>)</span>
<span id="cb69-32"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-32" tabindex="-1"></a></span>
<span id="cb69-33"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-33" tabindex="-1"></a><span class="co"># this layer is not added to github as a result of its large size and can be downloaded from SRTM (Farr et al. (2007))</span></span>
<span id="cb69-34"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-34" tabindex="-1"></a>alt.hills <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">crop</span>(alt, <span class="fu">as</span>(buffer, <span class="st">&quot;Spatial&quot;</span>))</span>
<span id="cb69-35"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-35" tabindex="-1"></a><span class="fu">rm</span>(alt)</span>
<span id="cb69-36"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-36" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb69-37"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-37" tabindex="-1"></a></span>
<span id="cb69-38"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-38" tabindex="-1"></a><span class="co"># get slope and aspect</span></span>
<span id="cb69-39"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-39" tabindex="-1"></a>slopeData <span class="ot">&lt;-</span> <span class="fu">terrain</span>(<span class="at">x =</span> alt.hills, <span class="at">v =</span> <span class="fu">c</span>(<span class="st">&quot;slope&quot;</span>, <span class="st">&quot;aspect&quot;</span>))</span>
<span id="cb69-40"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-40" tabindex="-1"></a><span class="co"># use c() on terra object to combine as a stack</span></span>
<span id="cb69-41"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-41" tabindex="-1"></a>elevData <span class="ot">&lt;-</span> <span class="fu">c</span>(alt.hills, slopeData)</span>
<span id="cb69-42"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-42" tabindex="-1"></a><span class="fu">rm</span>(alt.hills)</span>
<span id="cb69-43"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb69-43" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
</div>
<div id="load-the-climate-rasters" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Load the climate rasters<a href="analyzing-temperature-and-precipitation-change-over-time.html#load-the-climate-rasters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Note that there are four rasters: temperature and precipitation for both dry season and rainy season respectively. The dry season refers to the months of December to May while the rainy season refers to the months of June to November. Each raster corresponds to mean monthly value across a single decade (1870-1890 and so on). In other words, ppt_dry_1870 would refer to the mean monthly precipitation between December to May for the time-period 1870 to 1880.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-1" tabindex="-1"></a><span class="co"># use previously loaded climate reconstruction data</span></span>
<span id="cb70-2"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-2" tabindex="-1"></a>climate_reconstructed</span>
<span id="cb70-3"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-3" tabindex="-1"></a></span>
<span id="cb70-4"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-4" tabindex="-1"></a><span class="co"># crop each reconstruction to the previously prepared buffer</span></span>
<span id="cb70-5"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-5" tabindex="-1"></a><span class="co"># and transform/assign the crs of the site data</span></span>
<span id="cb70-6"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-6" tabindex="-1"></a>climate_reconst_nilgiris <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb70-7"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-7" tabindex="-1"></a>  climate_reconstructed, <span class="cf">function</span>(cl) {</span>
<span id="cb70-8"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-8" tabindex="-1"></a>    cl <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">project</span>(cl, <span class="fu">crs</span>(sites))</span>
<span id="cb70-9"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-9" tabindex="-1"></a>  }</span>
<span id="cb70-10"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-10" tabindex="-1"></a>)</span>
<span id="cb70-11"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-11" tabindex="-1"></a></span>
<span id="cb70-12"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-12" tabindex="-1"></a><span class="co"># extract the above data for each of the resurvye locations</span></span>
<span id="cb70-13"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-13" tabindex="-1"></a><span class="co"># use explicit namespacing of extract from terra, i.e., terra::extract</span></span>
<span id="cb70-14"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-14" tabindex="-1"></a>climate_reconst_sites <span class="ot">&lt;-</span> <span class="fu">lapply</span>(climate_reconst_nilgiris, <span class="cf">function</span>(cl) {</span>
<span id="cb70-15"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-15" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">extract</span>(cl, <span class="fu">as</span>(sites, <span class="st">&quot;SpatVector&quot;</span>))</span>
<span id="cb70-16"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-16" tabindex="-1"></a>})</span>
<span id="cb70-17"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-17" tabindex="-1"></a></span>
<span id="cb70-18"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-18" tabindex="-1"></a><span class="co"># extract elevation, aspect, slope at sites</span></span>
<span id="cb70-19"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-19" tabindex="-1"></a><span class="co"># first transform elevation data to UTM 43N</span></span>
<span id="cb70-20"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-20" tabindex="-1"></a>terrain_nilgiris <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">project</span>(elevData, <span class="fu">crs</span>(sites))</span>
<span id="cb70-21"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb70-21" tabindex="-1"></a>terrain_sites <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(terrain_nilgiris, <span class="fu">as</span>(sites, <span class="st">&quot;SpatVector&quot;</span>))</span></code></pre></div>
</div>
<div id="combine-site-climate-and-terrain-data" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Combine site climate and terrain data<a href="analyzing-temperature-and-precipitation-change-over-time.html#combine-site-climate-and-terrain-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-1" tabindex="-1"></a><span class="co"># merge all extracted climate data at sites</span></span>
<span id="cb71-2"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-2" tabindex="-1"></a>climate_reconst_sites <span class="ot">&lt;-</span> <span class="fu">reduce</span>(climate_reconst_sites, left_join)</span>
<span id="cb71-3"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-3" tabindex="-1"></a></span>
<span id="cb71-4"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-4" tabindex="-1"></a><span class="co"># now convert to long format</span></span>
<span id="cb71-5"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-5" tabindex="-1"></a>climate_reconst_sites <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(</span>
<span id="cb71-6"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-6" tabindex="-1"></a>  climate_reconst_sites,</span>
<span id="cb71-7"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-7" tabindex="-1"></a>  <span class="at">cols =</span> <span class="sc">!</span>ID,</span>
<span id="cb71-8"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-8" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">&quot;climate_measure&quot;</span></span>
<span id="cb71-9"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-9" tabindex="-1"></a>)</span>
<span id="cb71-10"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-10" tabindex="-1"></a></span>
<span id="cb71-11"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-11" tabindex="-1"></a><span class="co"># split season and year column</span></span>
<span id="cb71-12"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-12" tabindex="-1"></a>climate_reconst_sites <span class="ot">&lt;-</span> <span class="fu">separate_wider_regex</span>(</span>
<span id="cb71-13"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-13" tabindex="-1"></a>  climate_reconst_sites,</span>
<span id="cb71-14"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-14" tabindex="-1"></a>  <span class="at">cols =</span> climate_measure,</span>
<span id="cb71-15"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-15" tabindex="-1"></a>  <span class="at">patterns =</span> <span class="fu">c</span>(</span>
<span id="cb71-16"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-16" tabindex="-1"></a>    <span class="at">climate_measure =</span> <span class="st">&quot;.*&quot;</span>, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb71-17"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-17" tabindex="-1"></a>    <span class="at">season =</span> <span class="st">&quot;dry|rainy&quot;</span>, <span class="st">&quot;_&quot;</span>,</span>
<span id="cb71-18"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-18" tabindex="-1"></a>    <span class="at">year =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d{4}&quot;</span></span>
<span id="cb71-19"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-19" tabindex="-1"></a>  )</span>
<span id="cb71-20"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-20" tabindex="-1"></a>)</span>
<span id="cb71-21"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-21" tabindex="-1"></a></span>
<span id="cb71-22"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-22" tabindex="-1"></a><span class="co"># join with terrain data</span></span>
<span id="cb71-23"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-23" tabindex="-1"></a>clim_terrain_sites <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb71-24"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-24" tabindex="-1"></a>  climate_reconst_sites, terrain_sites</span>
<span id="cb71-25"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-25" tabindex="-1"></a>)</span>
<span id="cb71-26"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-26" tabindex="-1"></a></span>
<span id="cb71-27"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-27" tabindex="-1"></a><span class="co"># add site data - first drop</span></span>
<span id="cb71-28"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-28" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(sites) <span class="sc">%&gt;%</span></span>
<span id="cb71-29"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-29" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">seq</span>(<span class="fu">nrow</span>(sites))) <span class="sc">%&gt;%</span></span>
<span id="cb71-30"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-30" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb71-31"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-31" tabindex="-1"></a></span>
<span id="cb71-32"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-32" tabindex="-1"></a><span class="co"># join with site data</span></span>
<span id="cb71-33"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-33" tabindex="-1"></a>clim_terrain_sites <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb71-34"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-34" tabindex="-1"></a>  clim_terrain_sites,</span>
<span id="cb71-35"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-35" tabindex="-1"></a>  sites</span>
<span id="cb71-36"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-36" tabindex="-1"></a>)</span>
<span id="cb71-37"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-37" tabindex="-1"></a></span>
<span id="cb71-38"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-38" tabindex="-1"></a><span class="co"># make factors numerics</span></span>
<span id="cb71-39"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-39" tabindex="-1"></a>clim_terrain_sites <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb71-40"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-40" tabindex="-1"></a>  clim_terrain_sites,</span>
<span id="cb71-41"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-41" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">as.numeric</span>(year),</span>
<span id="cb71-42"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-42" tabindex="-1"></a>  <span class="at">alt =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(alt))</span>
<span id="cb71-43"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb71-43" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="plot-all-reconstructed-climate-over-time-colouring-by-elevation-and-grouping-by-site.-each-line-represents-one-modern-site-code." class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Plot all reconstructed climate over time colouring by elevation and grouping by site. Each line represents one modern site code.<a href="analyzing-temperature-and-precipitation-change-over-time.html#plot-all-reconstructed-climate-over-time-colouring-by-elevation-and-grouping-by-site.-each-line-represents-one-modern-site-code." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-1" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb72-2"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-2" tabindex="-1"></a>  clim_terrain_sites,</span>
<span id="cb72-3"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-3" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb72-4"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-4" tabindex="-1"></a>    <span class="at">x =</span> year, <span class="at">y =</span> value,</span>
<span id="cb72-5"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-5" tabindex="-1"></a>    <span class="at">col =</span> alt, <span class="at">group =</span> modern_site_code</span>
<span id="cb72-6"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-6" tabindex="-1"></a>  )</span>
<span id="cb72-7"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-7" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb72-8"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb72-9"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-9" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>)</span>
<span id="cb72-10"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-11"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-11" tabindex="-1"></a>  <span class="fu">scale_colour_binned_sequential</span>(</span>
<span id="cb72-12"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-12" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">&quot;Batlow&quot;</span></span>
<span id="cb72-13"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-14"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-14" tabindex="-1"></a>  <span class="fu">facet_grid</span>(</span>
<span id="cb72-15"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-15" tabindex="-1"></a>    <span class="at">rows =</span> <span class="fu">vars</span>(climate_measure),</span>
<span id="cb72-16"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-16" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">vars</span>(season),</span>
<span id="cb72-17"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-17" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>,</span>
<span id="cb72-18"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-18" tabindex="-1"></a>    <span class="at">labeller =</span> label_both</span>
<span id="cb72-19"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-20"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-20" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb72-21"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-21" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;Elev. (m)&quot;</span></span>
<span id="cb72-22"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-22" tabindex="-1"></a>  )</span>
<span id="cb72-23"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-23" tabindex="-1"></a></span>
<span id="cb72-24"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-24" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb72-25"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-25" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">&quot;figs/fig_clim_reconst_site_elev.png&quot;</span>,</span>
<span id="cb72-26"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-26" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">150</span></span>
<span id="cb72-27"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb72-27" tabindex="-1"></a>)</span></code></pre></div>
<div class="float">
<img src="figs/fig_clim_reconst_site_elev.png" alt="Reconstructed climate as a function of elevation across the last century" />
<div class="figcaption">Reconstructed climate as a function of elevation across the last century</div>
</div>
</div>
<div id="test-for-climate-change-over-time" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Test for climate change over time<a href="analyzing-temperature-and-precipitation-change-over-time.html#test-for-climate-change-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Run a GLMM for the value over time, with measure, season, historical site code, and modern land cover type as random effects.</p>
<p>All terrain covariates are fixed effects, and time is the main fixed effect of interest.</p>
<p>Save/report this model fit.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-1" tabindex="-1"></a><span class="co"># set site code and landcover as factors</span></span>
<span id="cb73-2"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-2" tabindex="-1"></a>clim_terrain_sites<span class="sc">$</span>historical_site_code <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(clim_terrain_sites<span class="sc">$</span>historical_site_code)</span>
<span id="cb73-3"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-3" tabindex="-1"></a>clim_terrain_sites<span class="sc">$</span>modern_landCover_type <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(clim_terrain_sites<span class="sc">$</span>modern_landCover_type)</span>
<span id="cb73-4"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-4" tabindex="-1"></a></span>
<span id="cb73-5"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-5" tabindex="-1"></a><span class="co"># split by measure</span></span>
<span id="cb73-6"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-6" tabindex="-1"></a>clim_terrain_sites <span class="ot">&lt;-</span> <span class="fu">nest</span>(</span>
<span id="cb73-7"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-7" tabindex="-1"></a>  clim_terrain_sites,</span>
<span id="cb73-8"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-8" tabindex="-1"></a>  <span class="at">.by =</span> climate_measure</span>
<span id="cb73-9"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-9" tabindex="-1"></a>)</span>
<span id="cb73-10"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-10" tabindex="-1"></a></span>
<span id="cb73-11"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-11" tabindex="-1"></a><span class="co"># run model</span></span>
<span id="cb73-12"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-12" tabindex="-1"></a>clim_terrain_sites <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb73-13"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-13" tabindex="-1"></a>  clim_terrain_sites,</span>
<span id="cb73-14"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-14" tabindex="-1"></a>  <span class="at">model_fit =</span> <span class="fu">map</span>(</span>
<span id="cb73-15"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-15" tabindex="-1"></a>    data,</span>
<span id="cb73-16"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-16" tabindex="-1"></a>    <span class="cf">function</span>(df) {</span>
<span id="cb73-17"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-17" tabindex="-1"></a>      <span class="fu">gam</span>(</span>
<span id="cb73-18"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-18" tabindex="-1"></a>        value <span class="sc">~</span> year <span class="sc">+</span> alt <span class="sc">+</span> slope <span class="sc">+</span> aspect <span class="sc">+</span> season <span class="sc">+</span></span>
<span id="cb73-19"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-19" tabindex="-1"></a>          <span class="fu">s</span>(historical_site_code, <span class="at">bs =</span> <span class="st">&quot;re&quot;</span>) <span class="sc">+</span></span>
<span id="cb73-20"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-20" tabindex="-1"></a>          <span class="fu">s</span>(modern_landCover_type, <span class="at">bs =</span> <span class="st">&quot;re&quot;</span>),</span>
<span id="cb73-21"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-21" tabindex="-1"></a>        <span class="at">data =</span> df</span>
<span id="cb73-22"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-22" tabindex="-1"></a>      )</span>
<span id="cb73-23"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-23" tabindex="-1"></a>    }</span>
<span id="cb73-24"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-24" tabindex="-1"></a>  )</span>
<span id="cb73-25"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-25" tabindex="-1"></a>)</span>
<span id="cb73-26"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-26" tabindex="-1"></a></span>
<span id="cb73-27"><a href="analyzing-temperature-and-precipitation-change-over-time.html#cb73-27" tabindex="-1"></a><span class="fu">map</span>(clim_terrain_sites<span class="sc">$</span>model_fit, summary)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reconstructing-climate-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="land-cover-classification-and-change-detection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/vjjan91/nilgiris-resurvey-project/edit/master/05_climate-change-analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
