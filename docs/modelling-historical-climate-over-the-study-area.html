<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 5 Modelling historical climate over the study area | Colonial-era landscape changes has led to grassland bird species declines over the last century</title>
  <meta name="description" content="Section 5 Modelling historical climate over the study area | Colonial-era landscape changes has led to grassland bird species declines over the last century" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 5 Modelling historical climate over the study area | Colonial-era landscape changes has led to grassland bird species declines over the last century" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="vjjan91/nilgiris-resurvey-project" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 5 Modelling historical climate over the study area | Colonial-era landscape changes has led to grassland bird species declines over the last century" />
  
  
  

<meta name="author" content="Vijay Ramesh" />
<meta name="author" content="VA Akshay" />
<meta name="author" content="Pratik Rajan Gupte" />
<meta name="author" content="Amrutha Rajan" />
<meta name="author" content="Chandrasekar Das" />
<meta name="author" content="Priyanka Hari Haran" />
<meta name="author" content="Ian Lockwood" />
<meta name="author" content="Ashwini Mohan" />
<meta name="author" content="Morgan W Tingley" />
<meta name="author" content="VV Robin" />
<meta name="author" content="Ruth S DeFries" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="building-a-correction-layer-for-climate-predictions.html"/>
<link rel="next" href="analyzing-temperature-and-precipitation-change-over-time.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#attribution"><i class="fa fa-check"></i><b>1.1</b> Attribution</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-access"><i class="fa fa-check"></i><b>1.2</b> Data access</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-processing"><i class="fa fa-check"></i><b>1.3</b> Data processing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="preparing-historical-climate-data-and-geographical-covariates.html"><a href="preparing-historical-climate-data-and-geographical-covariates.html"><i class="fa fa-check"></i><b>2</b> Preparing historical climate data and geographical covariates</a>
<ul>
<li class="chapter" data-level="2.1" data-path="preparing-historical-climate-data-and-geographical-covariates.html"><a href="preparing-historical-climate-data-and-geographical-covariates.html#load-libraries"><i class="fa fa-check"></i><b>2.1</b> Load libraries</a></li>
<li class="chapter" data-level="2.2" data-path="preparing-historical-climate-data-and-geographical-covariates.html"><a href="preparing-historical-climate-data-and-geographical-covariates.html#reading-raw-historical-climate-data"><i class="fa fa-check"></i><b>2.2</b> Reading raw historical climate data</a></li>
<li class="chapter" data-level="2.3" data-path="preparing-historical-climate-data-and-geographical-covariates.html"><a href="preparing-historical-climate-data-and-geographical-covariates.html#summarising-historical-climate-data"><i class="fa fa-check"></i><b>2.3</b> Summarising historical climate data</a></li>
<li class="chapter" data-level="2.4" data-path="preparing-historical-climate-data-and-geographical-covariates.html"><a href="preparing-historical-climate-data-and-geographical-covariates.html#prepare-study-area-spatial-extent"><i class="fa fa-check"></i><b>2.4</b> Prepare study area spatial extent</a></li>
<li class="chapter" data-level="2.5" data-path="preparing-historical-climate-data-and-geographical-covariates.html"><a href="preparing-historical-climate-data-and-geographical-covariates.html#prepare-spatial-data-for-the-study-area"><i class="fa fa-check"></i><b>2.5</b> Prepare spatial data for the study area</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="preparing-historical-climate-data-and-geographical-covariates.html"><a href="preparing-historical-climate-data-and-geographical-covariates.html#elevation-data"><i class="fa fa-check"></i><b>2.5.1</b> Elevation data</a></li>
<li class="chapter" data-level="2.5.2" data-path="preparing-historical-climate-data-and-geographical-covariates.html"><a href="preparing-historical-climate-data-and-geographical-covariates.html#distance-to-coast-data"><i class="fa fa-check"></i><b>2.5.2</b> Distance to coast data</a></li>
<li class="chapter" data-level="2.5.3" data-path="preparing-historical-climate-data-and-geographical-covariates.html"><a href="preparing-historical-climate-data-and-geographical-covariates.html#latitude-data"><i class="fa fa-check"></i><b>2.5.3</b> Latitude data</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="preparing-historical-climate-data-and-geographical-covariates.html"><a href="preparing-historical-climate-data-and-geographical-covariates.html#link-predictors-to-climate-data"><i class="fa fa-check"></i><b>2.6</b> Link predictors to climate data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html"><i class="fa fa-check"></i><b>3</b> Building and validating semi-spatial GAMs for climate</a>
<ul>
<li class="chapter" data-level="3.1" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#load-libraries-1"><i class="fa fa-check"></i><b>3.1</b> Load libraries</a></li>
<li class="chapter" data-level="3.2" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#prepare-linked-climate-spatial-data-and-spatial-data-for-modelling"><i class="fa fa-check"></i><b>3.2</b> Prepare linked climate-spatial data and spatial data for modelling</a></li>
<li class="chapter" data-level="3.3" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#fit-candidate-spatial-climate-models"><i class="fa fa-check"></i><b>3.3</b> Fit candidate spatial-climate models</a></li>
<li class="chapter" data-level="3.4" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#model-predictions-for-modern-climate"><i class="fa fa-check"></i><b>3.4</b> Model predictions for modern climate</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#average-predictions-over-1970-to-2010"><i class="fa fa-check"></i><b>3.4.1</b> Average predictions over 1970 to 2010</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#get-bioclim-data"><i class="fa fa-check"></i><b>3.5</b> Get BIOCLIM data</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#temperature-data"><i class="fa fa-check"></i><b>3.5.1</b> Temperature data</a></li>
<li class="chapter" data-level="3.5.2" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#precipitation-data"><i class="fa fa-check"></i><b>3.5.2</b> Precipitation data</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#compare-spatial-climate-model-predictions-against-bioclim-data"><i class="fa fa-check"></i><b>3.6</b> Compare spatial-climate model predictions against BIOCLIM data</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#sample-locations"><i class="fa fa-check"></i><b>3.6.1</b> Sample locations</a></li>
<li class="chapter" data-level="3.6.2" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#link-bioclim-data-and-model-predictions"><i class="fa fa-check"></i><b>3.6.2</b> Link BIOCLIM data and model predictions</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#error-between-model-prediction-and-chelsa-data"><i class="fa fa-check"></i><b>3.7</b> Error between model prediction and CHELSA data</a></li>
<li class="chapter" data-level="3.8" data-path="building-and-validating-semi-spatial-gams-for-climate.html"><a href="building-and-validating-semi-spatial-gams-for-climate.html#gam-predictions-at-survey-sites"><i class="fa fa-check"></i><b>3.8</b> GAM predictions at survey sites</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="building-a-correction-layer-for-climate-predictions.html"><a href="building-a-correction-layer-for-climate-predictions.html"><i class="fa fa-check"></i><b>4</b> Building a correction layer for climate predictions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="building-a-correction-layer-for-climate-predictions.html"><a href="building-a-correction-layer-for-climate-predictions.html#setup"><i class="fa fa-check"></i><b>4.1</b> Setup</a></li>
<li class="chapter" data-level="4.2" data-path="building-a-correction-layer-for-climate-predictions.html"><a href="building-a-correction-layer-for-climate-predictions.html#plot-model-error"><i class="fa fa-check"></i><b>4.2</b> Plot model error</a></li>
<li class="chapter" data-level="4.3" data-path="building-a-correction-layer-for-climate-predictions.html"><a href="building-a-correction-layer-for-climate-predictions.html#compare-climate-predictions-at-survey-sites"><i class="fa fa-check"></i><b>4.3</b> Compare climate predictions at survey sites</a></li>
<li class="chapter" data-level="4.4" data-path="building-a-correction-layer-for-climate-predictions.html"><a href="building-a-correction-layer-for-climate-predictions.html#visualise-model-predictions-as-proportion-of-remote-sensing-data"><i class="fa fa-check"></i><b>4.4</b> Visualise model predictions as proportion of remote sensing data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="building-a-correction-layer-for-climate-predictions.html"><a href="building-a-correction-layer-for-climate-predictions.html#temperature-scaling-layer"><i class="fa fa-check"></i><b>4.4.1</b> Temperature scaling layer</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="building-a-correction-layer-for-climate-predictions.html"><a href="building-a-correction-layer-for-climate-predictions.html#precipitation-scaling-layer"><i class="fa fa-check"></i><b>4.5</b> Precipitation scaling layer</a></li>
<li class="chapter" data-level="4.6" data-path="building-a-correction-layer-for-climate-predictions.html"><a href="building-a-correction-layer-for-climate-predictions.html#save-climate-scaling-layers"><i class="fa fa-check"></i><b>4.6</b> Save climate scaling layers</a></li>
<li class="chapter" data-level="4.7" data-path="building-a-correction-layer-for-climate-predictions.html"><a href="building-a-correction-layer-for-climate-predictions.html#seasonal-mean-temperature-correction-layer"><i class="fa fa-check"></i><b>4.7</b> Seasonal mean temperature correction layer</a></li>
<li class="chapter" data-level="4.8" data-path="building-a-correction-layer-for-climate-predictions.html"><a href="building-a-correction-layer-for-climate-predictions.html#seasonal-total-rainfall-correction-layer"><i class="fa fa-check"></i><b>4.8</b> Seasonal total rainfall correction layer</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelling-historical-climate-over-the-study-area.html"><a href="modelling-historical-climate-over-the-study-area.html"><i class="fa fa-check"></i><b>5</b> Modelling historical climate over the study area</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelling-historical-climate-over-the-study-area.html"><a href="modelling-historical-climate-over-the-study-area.html#setup-with-libraries-and-data"><i class="fa fa-check"></i><b>5.1</b> Setup with libraries and data</a></li>
<li class="chapter" data-level="5.2" data-path="modelling-historical-climate-over-the-study-area.html"><a href="modelling-historical-climate-over-the-study-area.html#model-climate-as-a-function-of-geographic-variables"><i class="fa fa-check"></i><b>5.2</b> Model climate as a function of geographic variables</a></li>
<li class="chapter" data-level="5.3" data-path="modelling-historical-climate-over-the-study-area.html"><a href="modelling-historical-climate-over-the-study-area.html#obtaining-model-predictions-over-the-study-area"><i class="fa fa-check"></i><b>5.3</b> Obtaining model predictions over the study area</a></li>
<li class="chapter" data-level="5.4" data-path="modelling-historical-climate-over-the-study-area.html"><a href="modelling-historical-climate-over-the-study-area.html#scaling-predicted-historical-climate"><i class="fa fa-check"></i><b>5.4</b> Scaling predicted historical climate</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html"><i class="fa fa-check"></i><b>6</b> Analyzing temperature and precipitation change over time</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#load-necessary-libraries"><i class="fa fa-check"></i><b>6.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="6.2" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#plot-change-in-climate-as-percentages."><i class="fa fa-check"></i><b>6.2</b> Plot change in climate as percentages.</a></li>
<li class="chapter" data-level="6.3" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#load-list-of-resurvey-locationshistorical-sites-of-occurrence"><i class="fa fa-check"></i><b>6.3</b> Load list of resurvey locations/historical sites of occurrence</a></li>
<li class="chapter" data-level="6.4" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#load-the-climate-rasters"><i class="fa fa-check"></i><b>6.4</b> Load the climate rasters</a></li>
<li class="chapter" data-level="6.5" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#combine-site-climate-and-terrain-data"><i class="fa fa-check"></i><b>6.5</b> Combine site climate and terrain data</a></li>
<li class="chapter" data-level="6.6" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#plot-all-reconstructed-climate-over-time-colouring-by-elevation-and-grouping-by-site.-each-line-represents-one-modern-site-code."><i class="fa fa-check"></i><b>6.6</b> Plot all reconstructed climate over time colouring by elevation and grouping by site. Each line represents one modern site code.</a></li>
<li class="chapter" data-level="6.7" data-path="analyzing-temperature-and-precipitation-change-over-time.html"><a href="analyzing-temperature-and-precipitation-change-over-time.html#test-for-climate-change-over-time"><i class="fa fa-check"></i><b>6.7</b> Test for climate change over time</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html"><i class="fa fa-check"></i><b>7</b> Land cover classification and change detection</a>
<ul>
<li class="chapter" data-level="7.1" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#load-necessary-libraries-1"><i class="fa fa-check"></i><b>7.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="7.2" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#processing-digitized-shapefiles-from-the-1848-map"><i class="fa fa-check"></i><b>7.2</b> Processing digitized shapefiles from the 1848 map</a></li>
<li class="chapter" data-level="7.3" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#rasterization-of-the-1848-shapefiles"><i class="fa fa-check"></i><b>7.3</b> Rasterization of the 1848 shapefiles</a></li>
<li class="chapter" data-level="7.4" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#load-the-2018-satellite-image"><i class="fa fa-check"></i><b>7.4</b> Load the 2018 satellite image</a></li>
<li class="chapter" data-level="7.5" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#subsume-plantations-into-one-category-for-2018"><i class="fa fa-check"></i><b>7.5</b> Subsume plantations into one category for 2018</a></li>
<li class="chapter" data-level="7.6" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#write-the-shapefiles-and-rasters-to-file"><i class="fa fa-check"></i><b>7.6</b> Write the shapefiles and rasters to file</a></li>
<li class="chapter" data-level="7.7" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#area-wise-comparisons-of-land-cover-change"><i class="fa fa-check"></i><b>7.7</b> Area-wise comparisons of land cover change</a></li>
<li class="chapter" data-level="7.8" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#barplots-of-land-cover-change"><i class="fa fa-check"></i><b>7.8</b> Barplots of land cover change</a></li>
<li class="chapter" data-level="7.9" data-path="land-cover-classification-and-change-detection.html"><a href="land-cover-classification-and-change-detection.html#validating-the-2018-sentinel-2-classification"><i class="fa fa-check"></i><b>7.9</b> Validating the 2018 Sentinel-2 classification</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html"><i class="fa fa-check"></i><b>8</b> Grassland contractions &amp; forest expansions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#load-necessary-libraries-2"><i class="fa fa-check"></i><b>8.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="8.2" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#load-processed-land-cover-rasters"><i class="fa fa-check"></i><b>8.2</b> Load processed land cover rasters</a></li>
<li class="chapter" data-level="8.3" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#visualize-forests-across-the-two-time-periods"><i class="fa fa-check"></i><b>8.3</b> Visualize forests across the two time periods</a></li>
<li class="chapter" data-level="8.4" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#visualize-grassland-area-across-the-two-time-periods"><i class="fa fa-check"></i><b>8.4</b> Visualize grassland area across the two time periods</a></li>
<li class="chapter" data-level="8.5" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#comparing-if-forests-have-increased-in-locations-where-grasslands-were-formerly-found"><i class="fa fa-check"></i><b>8.5</b> Comparing if forests have increased in locations where grasslands were formerly found?</a></li>
<li class="chapter" data-level="8.6" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#have-forests-expanded-across-elevations"><i class="fa fa-check"></i><b>8.6</b> Have forests expanded across elevations?</a></li>
<li class="chapter" data-level="8.7" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#how-do-grassland-patches-vary-by-elevation-across-time-periods"><i class="fa fa-check"></i><b>8.7</b> How do grassland patches vary by elevation across time periods?</a></li>
<li class="chapter" data-level="8.8" data-path="grassland-contractions-forest-expansions.html"><a href="grassland-contractions-forest-expansions.html#comparing-if-plantations-have-increased-in-locations-where-grasslands-were-formerly-found"><i class="fa fa-check"></i><b>8.8</b> Comparing if plantations have increased in locations where grasslands were formerly found?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html"><i class="fa fa-check"></i><b>9</b> Visualizing time series of change</a>
<ul>
<li class="chapter" data-level="9.1" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#load-necessary-libraries-3"><i class="fa fa-check"></i><b>9.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="9.2" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#load-processed-land-cover-rasters-1"><i class="fa fa-check"></i><b>9.2</b> Load processed land cover rasters</a></li>
<li class="chapter" data-level="9.3" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#loading-data-from-the-1910-map"><i class="fa fa-check"></i><b>9.3</b> Loading data from the 1910 map</a></li>
<li class="chapter" data-level="9.4" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#rasterizing-of-the-1910-data"><i class="fa fa-check"></i><b>9.4</b> Rasterizing of the 1910 data</a></li>
<li class="chapter" data-level="9.5" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#loading-the-1973-and-1995-data"><i class="fa fa-check"></i><b>9.5</b> Loading the 1973 and 1995 data</a></li>
<li class="chapter" data-level="9.6" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#rasterization-of-the-1973-and-1995-data"><i class="fa fa-check"></i><b>9.6</b> Rasterization of the 1973 and 1995 data</a></li>
<li class="chapter" data-level="9.7" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#visualization-of-landscape-change-over-time"><i class="fa fa-check"></i><b>9.7</b> Visualization of landscape change over time</a></li>
<li class="chapter" data-level="9.8" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#subsume-plantations-into-one-category-for-1973-1995-and-2018"><i class="fa fa-check"></i><b>9.8</b> Subsume plantations into one category for 1973, 1995, and 2018</a></li>
<li class="chapter" data-level="9.9" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#creating-smaller-regions-of-interest-for-comparison"><i class="fa fa-check"></i><b>9.9</b> Creating smaller regions of interest for comparison</a></li>
<li class="chapter" data-level="9.10" data-path="visualizing-time-series-of-change.html"><a href="visualizing-time-series-of-change.html#comparisons-only-above-1400-meters-in-elevation"><i class="fa fa-check"></i><b>9.10</b> Comparisons only above 1400 meters in elevation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html"><i class="fa fa-check"></i><b>10</b> Exploratory analysis of occurrence data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html#load-necessary-libraries-4"><i class="fa fa-check"></i><b>10.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="10.2" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html#load-the-historical-occurrence-data-and-explore-patterns"><i class="fa fa-check"></i><b>10.2</b> Load the historical occurrence data and explore patterns</a></li>
<li class="chapter" data-level="10.3" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html#examining-historical-data-by-locality"><i class="fa fa-check"></i><b>10.3</b> Examining historical data by locality</a></li>
<li class="chapter" data-level="10.4" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html#visualizations-of-historical-data"><i class="fa fa-check"></i><b>10.4</b> Visualizations of historical data</a></li>
<li class="chapter" data-level="10.5" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html#examining-species-specific-counts-by-locality"><i class="fa fa-check"></i><b>10.5</b> Examining species specific counts by locality</a></li>
<li class="chapter" data-level="10.6" data-path="exploratory-analysis-of-occurrence-data.html"><a href="exploratory-analysis-of-occurrence-data.html#load-modern-occurrence-data-and-explore-patterns"><i class="fa fa-check"></i><b>10.6</b> Load modern occurrence data and explore patterns</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html"><i class="fa fa-check"></i><b>11</b> Species relative abundances over time</a>
<ul>
<li class="chapter" data-level="11.1" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#load-necessary-libraries-5"><i class="fa fa-check"></i><b>11.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="11.2" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#load-list-of-resurvey-locations"><i class="fa fa-check"></i><b>11.2</b> Load list of resurvey locations</a></li>
<li class="chapter" data-level="11.3" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#calibrating-historical-data-to-modern-survey-data-for-relative-abundance-calculations"><i class="fa fa-check"></i><b>11.3</b> Calibrating historical data to modern survey data for relative abundance calculations</a></li>
<li class="chapter" data-level="11.4" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#calculating-species-relative-abundance-for-the-historical-data-1850-1900-and-1900-1950"><i class="fa fa-check"></i><b>11.4</b> Calculating species relative abundance for the historical data (1850-1900 and 1900-1950)</a></li>
<li class="chapter" data-level="11.5" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#load-the-modern-occurrence-data"><i class="fa fa-check"></i><b>11.5</b> Load the modern occurrence data</a></li>
<li class="chapter" data-level="11.6" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#calculate-dirichlet-distributions-of-relative-abundance"><i class="fa fa-check"></i><b>11.6</b> Calculate dirichlet distributions of relative abundance</a></li>
<li class="chapter" data-level="11.7" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#boxplot-visualization-of-overall-relative-abundance-across-time-periods"><i class="fa fa-check"></i><b>11.7</b> Boxplot visualization of overall relative abundance across time periods</a></li>
<li class="chapter" data-level="11.8" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#species-relative-abundances-at-the-site-level"><i class="fa fa-check"></i><b>11.8</b> Species relative abundances at the site-level</a></li>
<li class="chapter" data-level="11.9" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#visualizing-differences-in-relative-abundance-over-time-at-the-site-level"><i class="fa fa-check"></i><b>11.9</b> Visualizing differences in relative abundance over time at the site level</a></li>
<li class="chapter" data-level="11.10" data-path="species-relative-abundances-over-time.html"><a href="species-relative-abundances-over-time.html#writing-results-to-file"><i class="fa fa-check"></i><b>11.10</b> Writing results to file</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><i class="fa fa-check"></i><b>12</b> Examining changes in relative abundance over time as a function of species habitat affiliation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#load-necessary-libraries-6"><i class="fa fa-check"></i><b>12.1</b> Load necessary libraries</a></li>
<li class="chapter" data-level="12.2" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#load-data-on-species-relative-abundances"><i class="fa fa-check"></i><b>12.2</b> Load data on species relative abundances</a></li>
<li class="chapter" data-level="12.3" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#load-species-trait-data"><i class="fa fa-check"></i><b>12.3</b> Load species trait data</a></li>
<li class="chapter" data-level="12.4" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#visualizing-relative-abundance-change-by-species-across-time-periods-for-grassland-bird-species"><i class="fa fa-check"></i><b>12.4</b> Visualizing relative abundance change by species across time periods for grassland bird species</a></li>
<li class="chapter" data-level="12.5" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#rank-abundance-plots-of-relative-abundance-by-species-trait-across-time-periods"><i class="fa fa-check"></i><b>12.5</b> Rank abundance plots of relative abundance by species trait across time periods</a></li>
<li class="chapter" data-level="12.6" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#are-there-significant-decreases-in-relative-abundance-by-time-periods-across-habitat-affiliations"><i class="fa fa-check"></i><b>12.6</b> Are there significant decreases in relative abundance by time periods across habitat affiliations?</a></li>
<li class="chapter" data-level="12.7" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#forest-birds"><i class="fa fa-check"></i><b>12.7</b> Forest birds</a></li>
<li class="chapter" data-level="12.8" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#grassland-birds"><i class="fa fa-check"></i><b>12.8</b> Grassland birds</a></li>
<li class="chapter" data-level="12.9" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#generalist-birds"><i class="fa fa-check"></i><b>12.9</b> Generalist birds</a></li>
<li class="chapter" data-level="12.10" data-path="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html"><a href="examining-changes-in-relative-abundance-over-time-as-a-function-of-species-habitat-affiliation.html#creating-a-combined-figure-for-the-above-three-models"><i class="fa fa-check"></i><b>12.10</b> Creating a combined figure for the above three models</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Colonial-era landscape changes has led to grassland bird species declines over the last century</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelling-historical-climate-over-the-study-area" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Section 5</span> Modelling historical climate over the study area<a href="modelling-historical-climate-over-the-study-area.html#modelling-historical-climate-over-the-study-area" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Here we use the model formulation chosen in the previous section to model climate variables as a function of geographical predictors over the study area.
We use one model formula (henceforth, model) for each climate variable in each season.
We model historical climate for 30 year periods, as this is about the temporal resolution of interest.</p>
<div id="setup-with-libraries-and-data" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Setup with libraries and data<a href="modelling-historical-climate-over-the-study-area.html#setup-with-libraries-and-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="modelling-historical-climate-over-the-study-area.html#cb47-1" tabindex="-1"></a><span class="co"># for data</span></span>
<span id="cb47-2"><a href="modelling-historical-climate-over-the-study-area.html#cb47-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb47-3"><a href="modelling-historical-climate-over-the-study-area.html#cb47-3" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb47-4"><a href="modelling-historical-climate-over-the-study-area.html#cb47-4" tabindex="-1"></a></span>
<span id="cb47-5"><a href="modelling-historical-climate-over-the-study-area.html#cb47-5" tabindex="-1"></a><span class="co"># for gam</span></span>
<span id="cb47-6"><a href="modelling-historical-climate-over-the-study-area.html#cb47-6" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb47-7"><a href="modelling-historical-climate-over-the-study-area.html#cb47-7" tabindex="-1"></a></span>
<span id="cb47-8"><a href="modelling-historical-climate-over-the-study-area.html#cb47-8" tabindex="-1"></a><span class="co"># for rasters</span></span>
<span id="cb47-9"><a href="modelling-historical-climate-over-the-study-area.html#cb47-9" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="modelling-historical-climate-over-the-study-area.html#cb48-1" tabindex="-1"></a><span class="co"># Read in geographical covariates of weather data locations</span></span>
<span id="cb48-2"><a href="modelling-historical-climate-over-the-study-area.html#cb48-2" tabindex="-1"></a><span class="co"># and rasters of spatial data</span></span>
<span id="cb48-3"><a href="modelling-historical-climate-over-the-study-area.html#cb48-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;results/climate/data_for_gam.csv&quot;</span>)</span>
<span id="cb48-4"><a href="modelling-historical-climate-over-the-study-area.html#cb48-4" tabindex="-1"></a>stack <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">&quot;results/climate/raster_gam_stack.tif&quot;</span>)</span></code></pre></div>
</div>
<div id="model-climate-as-a-function-of-geographic-variables" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Model climate as a function of geographic variables<a href="modelling-historical-climate-over-the-study-area.html#model-climate-as-a-function-of-geographic-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here we prepare the data and model climate variables as a function of geographic variables.
As in the section on modelling the contemporary climate, we add some small error to each geographic variable to facilitate model fitting.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="modelling-historical-climate-over-the-study-area.html#cb49-1" tabindex="-1"></a><span class="co"># Prepare geographic variables</span></span>
<span id="cb49-2"><a href="modelling-historical-climate-over-the-study-area.html#cb49-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb49-3"><a href="modelling-historical-climate-over-the-study-area.html#cb49-3" tabindex="-1"></a>  data,</span>
<span id="cb49-4"><a href="modelling-historical-climate-over-the-study-area.html#cb49-4" tabindex="-1"></a></span>
<span id="cb49-5"><a href="modelling-historical-climate-over-the-study-area.html#cb49-5" tabindex="-1"></a>  <span class="co"># divide distance by 1000 for km</span></span>
<span id="cb49-6"><a href="modelling-historical-climate-over-the-study-area.html#cb49-6" tabindex="-1"></a>  <span class="at">coast =</span> coast <span class="sc">/</span> <span class="dv">1000</span>,</span>
<span id="cb49-7"><a href="modelling-historical-climate-over-the-study-area.html#cb49-7" tabindex="-1"></a></span>
<span id="cb49-8"><a href="modelling-historical-climate-over-the-study-area.html#cb49-8" tabindex="-1"></a>  <span class="co"># add some error to all physical variables</span></span>
<span id="cb49-9"><a href="modelling-historical-climate-over-the-study-area.html#cb49-9" tabindex="-1"></a>  <span class="co"># hopefully prevents model issues</span></span>
<span id="cb49-10"><a href="modelling-historical-climate-over-the-study-area.html#cb49-10" tabindex="-1"></a>  <span class="at">coast =</span> coast <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(coast), <span class="fl">0.1</span>, <span class="at">sd =</span> <span class="fl">0.01</span>),</span>
<span id="cb49-11"><a href="modelling-historical-climate-over-the-study-area.html#cb49-11" tabindex="-1"></a>  <span class="at">elev =</span> elev <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(coast), <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.01</span>),</span>
<span id="cb49-12"><a href="modelling-historical-climate-over-the-study-area.html#cb49-12" tabindex="-1"></a>  <span class="at">lat =</span> lat <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(lat), <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.01</span>)</span>
<span id="cb49-13"><a href="modelling-historical-climate-over-the-study-area.html#cb49-13" tabindex="-1"></a>)</span>
<span id="cb49-14"><a href="modelling-historical-climate-over-the-study-area.html#cb49-14" tabindex="-1"></a></span>
<span id="cb49-15"><a href="modelling-historical-climate-over-the-study-area.html#cb49-15" tabindex="-1"></a><span class="co"># set distance to coast raster in km</span></span>
<span id="cb49-16"><a href="modelling-historical-climate-over-the-study-area.html#cb49-16" tabindex="-1"></a><span class="fu">values</span>(stack[[<span class="st">&quot;coast&quot;</span>]]) <span class="ot">&lt;-</span> <span class="fu">values</span>(stack[[<span class="st">&quot;coast&quot;</span>]]) <span class="sc">/</span> <span class="dv">1000</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="modelling-historical-climate-over-the-study-area.html#cb50-1" tabindex="-1"></a><span class="co"># Pivot the data to long format and remove the SD of temperature</span></span>
<span id="cb50-2"><a href="modelling-historical-climate-over-the-study-area.html#cb50-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(</span>
<span id="cb50-3"><a href="modelling-historical-climate-over-the-study-area.html#cb50-3" tabindex="-1"></a>  data,</span>
<span id="cb50-4"><a href="modelling-historical-climate-over-the-study-area.html#cb50-4" tabindex="-1"></a>  <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;ppt&quot;</span>, <span class="st">&quot;t_mean&quot;</span>, <span class="st">&quot;t_sd&quot;</span>),</span>
<span id="cb50-5"><a href="modelling-historical-climate-over-the-study-area.html#cb50-5" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">&quot;climvar&quot;</span></span>
<span id="cb50-6"><a href="modelling-historical-climate-over-the-study-area.html#cb50-6" tabindex="-1"></a>)</span>
<span id="cb50-7"><a href="modelling-historical-climate-over-the-study-area.html#cb50-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(data, <span class="sc">!</span>month)</span>
<span id="cb50-8"><a href="modelling-historical-climate-over-the-study-area.html#cb50-8" tabindex="-1"></a></span>
<span id="cb50-9"><a href="modelling-historical-climate-over-the-study-area.html#cb50-9" tabindex="-1"></a><span class="co"># remove t_sd</span></span>
<span id="cb50-10"><a href="modelling-historical-climate-over-the-study-area.html#cb50-10" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">filter</span>(</span>
<span id="cb50-11"><a href="modelling-historical-climate-over-the-study-area.html#cb50-11" tabindex="-1"></a>  data, climvar <span class="sc">!=</span> <span class="st">&quot;t_sd&quot;</span></span>
<span id="cb50-12"><a href="modelling-historical-climate-over-the-study-area.html#cb50-12" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="modelling-historical-climate-over-the-study-area.html#cb51-1" tabindex="-1"></a><span class="co"># Nest the data by climate variable, season, and 30-year bin</span></span>
<span id="cb51-2"><a href="modelling-historical-climate-over-the-study-area.html#cb51-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">nest</span>(</span>
<span id="cb51-3"><a href="modelling-historical-climate-over-the-study-area.html#cb51-3" tabindex="-1"></a>  data,</span>
<span id="cb51-4"><a href="modelling-historical-climate-over-the-study-area.html#cb51-4" tabindex="-1"></a>  <span class="at">data =</span> <span class="sc">!</span><span class="fu">c</span>(climvar, season, year_bin)</span>
<span id="cb51-5"><a href="modelling-historical-climate-over-the-study-area.html#cb51-5" tabindex="-1"></a>)</span></code></pre></div>
<p>We specify the GAM formulas for temperature and precipitation, chosen in the previous section after examining the mean absolute error (MAE) of predictions for contemporary data (i.e., compared against remotely sensed data).</p>
<p>Temperature is modelled as a smooth function of elevation with three knots.
Precipitation is modelled as a smooth function of elevation with three knots, with linear terms for distance from the coast and latitude.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="modelling-historical-climate-over-the-study-area.html#cb52-1" tabindex="-1"></a><span class="co"># model formula for temp</span></span>
<span id="cb52-2"><a href="modelling-historical-climate-over-the-study-area.html#cb52-2" tabindex="-1"></a>form_temp <span class="ot">&lt;-</span> <span class="st">&quot;value ~ s(elev, k = 3)&quot;</span></span>
<span id="cb52-3"><a href="modelling-historical-climate-over-the-study-area.html#cb52-3" tabindex="-1"></a></span>
<span id="cb52-4"><a href="modelling-historical-climate-over-the-study-area.html#cb52-4" tabindex="-1"></a><span class="co"># model formula for ppt</span></span>
<span id="cb52-5"><a href="modelling-historical-climate-over-the-study-area.html#cb52-5" tabindex="-1"></a>form_ppt <span class="ot">&lt;-</span> <span class="st">&quot;value ~ s(elev, k = 3) + coast + lat&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="modelling-historical-climate-over-the-study-area.html#cb53-1" tabindex="-1"></a><span class="co"># Assign formula as a character column in the nested data.frame</span></span>
<span id="cb53-2"><a href="modelling-historical-climate-over-the-study-area.html#cb53-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb53-3"><a href="modelling-historical-climate-over-the-study-area.html#cb53-3" tabindex="-1"></a>  data,</span>
<span id="cb53-4"><a href="modelling-historical-climate-over-the-study-area.html#cb53-4" tabindex="-1"></a>  <span class="at">form =</span> <span class="fu">if_else</span>(</span>
<span id="cb53-5"><a href="modelling-historical-climate-over-the-study-area.html#cb53-5" tabindex="-1"></a>    climvar <span class="sc">==</span> <span class="st">&quot;t_mean&quot;</span>, form_temp, form_ppt</span>
<span id="cb53-6"><a href="modelling-historical-climate-over-the-study-area.html#cb53-6" tabindex="-1"></a>  )</span>
<span id="cb53-7"><a href="modelling-historical-climate-over-the-study-area.html#cb53-7" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="modelling-historical-climate-over-the-study-area.html#cb54-1" tabindex="-1"></a><span class="co"># Fit models for each climate variable, season, and year bin</span></span>
<span id="cb54-2"><a href="modelling-historical-climate-over-the-study-area.html#cb54-2" tabindex="-1"></a><span class="co"># Note that the formulae are converted to the `&lt;formula&gt;` class</span></span>
<span id="cb54-3"><a href="modelling-historical-climate-over-the-study-area.html#cb54-3" tabindex="-1"></a><span class="co"># using `as.formula()`</span></span>
<span id="cb54-4"><a href="modelling-historical-climate-over-the-study-area.html#cb54-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb54-5"><a href="modelling-historical-climate-over-the-study-area.html#cb54-5" tabindex="-1"></a>  data,</span>
<span id="cb54-6"><a href="modelling-historical-climate-over-the-study-area.html#cb54-6" tabindex="-1"></a>  <span class="at">mod =</span> <span class="fu">map2</span>(data, form, <span class="cf">function</span>(df, form) {</span>
<span id="cb54-7"><a href="modelling-historical-climate-over-the-study-area.html#cb54-7" tabindex="-1"></a>    <span class="fu">gam</span>(</span>
<span id="cb54-8"><a href="modelling-historical-climate-over-the-study-area.html#cb54-8" tabindex="-1"></a>      <span class="at">formula =</span> <span class="fu">as.formula</span>(form),</span>
<span id="cb54-9"><a href="modelling-historical-climate-over-the-study-area.html#cb54-9" tabindex="-1"></a>      <span class="at">data =</span> df</span>
<span id="cb54-10"><a href="modelling-historical-climate-over-the-study-area.html#cb54-10" tabindex="-1"></a>    )</span>
<span id="cb54-11"><a href="modelling-historical-climate-over-the-study-area.html#cb54-11" tabindex="-1"></a>  })</span>
<span id="cb54-12"><a href="modelling-historical-climate-over-the-study-area.html#cb54-12" tabindex="-1"></a>)</span>
<span id="cb54-13"><a href="modelling-historical-climate-over-the-study-area.html#cb54-13" tabindex="-1"></a></span>
<span id="cb54-14"><a href="modelling-historical-climate-over-the-study-area.html#cb54-14" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: if mgcv::gam() is excessively slow, consider mgcv::bam() which is</span></span>
<span id="cb54-15"><a href="modelling-historical-climate-over-the-study-area.html#cb54-15" tabindex="-1"></a><span class="co"># said to be more suitable for large datasets</span></span></code></pre></div>
<p>We save the model as an R data object.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="modelling-historical-climate-over-the-study-area.html#cb55-1" tabindex="-1"></a><span class="fu">save</span>(data, <span class="at">file =</span> <span class="st">&quot;results/climate/model_reconstruction_climate.Rds&quot;</span>)</span></code></pre></div>
</div>
<div id="obtaining-model-predictions-over-the-study-area" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Obtaining model predictions over the study area<a href="modelling-historical-climate-over-the-study-area.html#obtaining-model-predictions-over-the-study-area" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We use the <code>predict()</code> method to get climate predictions over the study area, using the spatial raster data as inputs.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="modelling-historical-climate-over-the-study-area.html#cb56-1" tabindex="-1"></a><span class="co"># ensure that NAs are removed from the stack object before running the model</span></span>
<span id="cb56-2"><a href="modelling-historical-climate-over-the-study-area.html#cb56-2" tabindex="-1"></a><span class="co"># projections</span></span>
<span id="cb56-3"><a href="modelling-historical-climate-over-the-study-area.html#cb56-3" tabindex="-1"></a></span>
<span id="cb56-4"><a href="modelling-historical-climate-over-the-study-area.html#cb56-4" tabindex="-1"></a><span class="co"># this tells us that two raster layers within the stack object have NA values</span></span>
<span id="cb56-5"><a href="modelling-historical-climate-over-the-study-area.html#cb56-5" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">global</span>(stack, <span class="at">fun =</span> <span class="st">&quot;isNA&quot;</span>)</span>
<span id="cb56-6"><a href="modelling-historical-climate-over-the-study-area.html#cb56-6" tabindex="-1"></a></span>
<span id="cb56-7"><a href="modelling-historical-climate-over-the-study-area.html#cb56-7" tabindex="-1"></a><span class="co"># Replace NAs with 0s for distance to coast</span></span>
<span id="cb56-8"><a href="modelling-historical-climate-over-the-study-area.html#cb56-8" tabindex="-1"></a>stack<span class="sc">$</span>coast[<span class="fu">is.na</span>(stack<span class="sc">$</span>coast)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb56-9"><a href="modelling-historical-climate-over-the-study-area.html#cb56-9" tabindex="-1"></a></span>
<span id="cb56-10"><a href="modelling-historical-climate-over-the-study-area.html#cb56-10" tabindex="-1"></a><span class="co"># Replace elevations &lt; 0 with NA and then 0</span></span>
<span id="cb56-11"><a href="modelling-historical-climate-over-the-study-area.html#cb56-11" tabindex="-1"></a>stack<span class="sc">$</span>elev[stack<span class="sc">$</span>elev <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb56-12"><a href="modelling-historical-climate-over-the-study-area.html#cb56-12" tabindex="-1"></a>stack<span class="sc">$</span>elev[<span class="fu">is.na</span>(stack<span class="sc">$</span>elev)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb56-13"><a href="modelling-historical-climate-over-the-study-area.html#cb56-13" tabindex="-1"></a>stack<span class="sc">$</span>elev <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(stack<span class="sc">$</span>elev)</span>
<span id="cb56-14"><a href="modelling-historical-climate-over-the-study-area.html#cb56-14" tabindex="-1"></a></span>
<span id="cb56-15"><a href="modelling-historical-climate-over-the-study-area.html#cb56-15" tabindex="-1"></a><span class="co"># Get model predictions</span></span>
<span id="cb56-16"><a href="modelling-historical-climate-over-the-study-area.html#cb56-16" tabindex="-1"></a>model_pred <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb56-17"><a href="modelling-historical-climate-over-the-study-area.html#cb56-17" tabindex="-1"></a>  data<span class="sc">$</span>mod, <span class="cf">function</span>(g) {</span>
<span id="cb56-18"><a href="modelling-historical-climate-over-the-study-area.html#cb56-18" tabindex="-1"></a>    <span class="fu">predict</span>(stack, g, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># order matters here</span></span>
<span id="cb56-19"><a href="modelling-historical-climate-over-the-study-area.html#cb56-19" tabindex="-1"></a>  }</span>
<span id="cb56-20"><a href="modelling-historical-climate-over-the-study-area.html#cb56-20" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="modelling-historical-climate-over-the-study-area.html#cb57-1" tabindex="-1"></a><span class="co"># Assign predicted climate rasters as list column object</span></span>
<span id="cb57-2"><a href="modelling-historical-climate-over-the-study-area.html#cb57-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb57-3"><a href="modelling-historical-climate-over-the-study-area.html#cb57-3" tabindex="-1"></a>  data,</span>
<span id="cb57-4"><a href="modelling-historical-climate-over-the-study-area.html#cb57-4" tabindex="-1"></a>  <span class="at">pred =</span> model_pred</span>
<span id="cb57-5"><a href="modelling-historical-climate-over-the-study-area.html#cb57-5" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="modelling-historical-climate-over-the-study-area.html#cb58-1" tabindex="-1"></a><span class="co"># Ungroup the data and select relevant columns</span></span>
<span id="cb58-2"><a href="modelling-historical-climate-over-the-study-area.html#cb58-2" tabindex="-1"></a>data_pred <span class="ot">&lt;-</span> <span class="fu">ungroup</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="modelling-historical-climate-over-the-study-area.html#cb58-3" tabindex="-1"></a>  <span class="fu">select</span>(season, year_bin, climvar, pred)</span></code></pre></div>
</div>
<div id="scaling-predicted-historical-climate" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Scaling predicted historical climate<a href="modelling-historical-climate-over-the-study-area.html#scaling-predicted-historical-climate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here we aim to scale the predicted historical climate using the scaling layers developed in the previous section.
The idea is that the predicted historical climate differs from the true historical climate over the study area in the same way (i.e., with the same ratio) that the contemporary climate prediction differs from the canonical (remotely sensed) climate variables.</p>
<p>We read in the scaling layers and apply them to the data (taking the cell-wise product of the two).</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="modelling-historical-climate-over-the-study-area.html#cb59-1" tabindex="-1"></a><span class="co"># Read in scaling layers</span></span>
<span id="cb59-2"><a href="modelling-historical-climate-over-the-study-area.html#cb59-2" tabindex="-1"></a>temp_correction <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(</span>
<span id="cb59-3"><a href="modelling-historical-climate-over-the-study-area.html#cb59-3" tabindex="-1"></a>  <span class="st">&quot;results/climate/raster_correction_layers_temp.tif&quot;</span></span>
<span id="cb59-4"><a href="modelling-historical-climate-over-the-study-area.html#cb59-4" tabindex="-1"></a>)</span>
<span id="cb59-5"><a href="modelling-historical-climate-over-the-study-area.html#cb59-5" tabindex="-1"></a></span>
<span id="cb59-6"><a href="modelling-historical-climate-over-the-study-area.html#cb59-6" tabindex="-1"></a>ppt_correction <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(</span>
<span id="cb59-7"><a href="modelling-historical-climate-over-the-study-area.html#cb59-7" tabindex="-1"></a>  <span class="st">&quot;results/climate/raster_correction_layers_ppt.tif&quot;</span></span>
<span id="cb59-8"><a href="modelling-historical-climate-over-the-study-area.html#cb59-8" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="modelling-historical-climate-over-the-study-area.html#cb60-1" tabindex="-1"></a><span class="co"># Match scaling layers to the appropriate prediction layer</span></span>
<span id="cb60-2"><a href="modelling-historical-climate-over-the-study-area.html#cb60-2" tabindex="-1"></a>data_pred <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb60-3"><a href="modelling-historical-climate-over-the-study-area.html#cb60-3" tabindex="-1"></a>  data_pred,</span>
<span id="cb60-4"><a href="modelling-historical-climate-over-the-study-area.html#cb60-4" tabindex="-1"></a>  <span class="at">correction =</span> <span class="fu">map2</span>(</span>
<span id="cb60-5"><a href="modelling-historical-climate-over-the-study-area.html#cb60-5" tabindex="-1"></a>    season, climvar, <span class="cf">function</span>(season, climvar) {</span>
<span id="cb60-6"><a href="modelling-historical-climate-over-the-study-area.html#cb60-6" tabindex="-1"></a>      <span class="cf">if</span> (season <span class="sc">==</span> <span class="st">&quot;dry&quot;</span> <span class="sc">&amp;</span> climvar <span class="sc">==</span> <span class="st">&quot;ppt&quot;</span>) {</span>
<span id="cb60-7"><a href="modelling-historical-climate-over-the-study-area.html#cb60-7" tabindex="-1"></a>        ppt_correction[[<span class="st">&quot;correction_layer_ppt_dry&quot;</span>]]</span>
<span id="cb60-8"><a href="modelling-historical-climate-over-the-study-area.html#cb60-8" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (season <span class="sc">==</span> <span class="st">&quot;dry&quot;</span> <span class="sc">&amp;</span> climvar <span class="sc">==</span> <span class="st">&quot;temp&quot;</span>) {</span>
<span id="cb60-9"><a href="modelling-historical-climate-over-the-study-area.html#cb60-9" tabindex="-1"></a>        temp_correction[[<span class="st">&quot;correction_layer_temp_dry&quot;</span>]]</span>
<span id="cb60-10"><a href="modelling-historical-climate-over-the-study-area.html#cb60-10" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (season <span class="sc">==</span> <span class="st">&quot;wet&quot;</span> <span class="sc">&amp;</span> climvar <span class="sc">==</span> <span class="st">&quot;ppt&quot;</span>) {</span>
<span id="cb60-11"><a href="modelling-historical-climate-over-the-study-area.html#cb60-11" tabindex="-1"></a>        ppt_correction[[<span class="st">&quot;correction_layer_ppt_wet&quot;</span>]]</span>
<span id="cb60-12"><a href="modelling-historical-climate-over-the-study-area.html#cb60-12" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb60-13"><a href="modelling-historical-climate-over-the-study-area.html#cb60-13" tabindex="-1"></a>        temp_correction[[<span class="st">&quot;correction_layer_temp_wet&quot;</span>]]</span>
<span id="cb60-14"><a href="modelling-historical-climate-over-the-study-area.html#cb60-14" tabindex="-1"></a>      }</span>
<span id="cb60-15"><a href="modelling-historical-climate-over-the-study-area.html#cb60-15" tabindex="-1"></a>    }</span>
<span id="cb60-16"><a href="modelling-historical-climate-over-the-study-area.html#cb60-16" tabindex="-1"></a>  )</span>
<span id="cb60-17"><a href="modelling-historical-climate-over-the-study-area.html#cb60-17" tabindex="-1"></a>)</span>
<span id="cb60-18"><a href="modelling-historical-climate-over-the-study-area.html#cb60-18" tabindex="-1"></a></span>
<span id="cb60-19"><a href="modelling-historical-climate-over-the-study-area.html#cb60-19" tabindex="-1"></a><span class="co"># Scale predicted historical climate by cell-wise product of</span></span>
<span id="cb60-20"><a href="modelling-historical-climate-over-the-study-area.html#cb60-20" tabindex="-1"></a><span class="co"># prediction and scaling layer</span></span>
<span id="cb60-21"><a href="modelling-historical-climate-over-the-study-area.html#cb60-21" tabindex="-1"></a>data_pred <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb60-22"><a href="modelling-historical-climate-over-the-study-area.html#cb60-22" tabindex="-1"></a>  data_pred,</span>
<span id="cb60-23"><a href="modelling-historical-climate-over-the-study-area.html#cb60-23" tabindex="-1"></a>  <span class="at">corrected =</span> <span class="fu">map2</span>(</span>
<span id="cb60-24"><a href="modelling-historical-climate-over-the-study-area.html#cb60-24" tabindex="-1"></a>    correction, pred, <span class="cf">function</span>(ch, pr) {</span>
<span id="cb60-25"><a href="modelling-historical-climate-over-the-study-area.html#cb60-25" tabindex="-1"></a>      pr <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">resample</span>(pr, ch) <span class="co"># resampling required</span></span>
<span id="cb60-26"><a href="modelling-historical-climate-over-the-study-area.html#cb60-26" tabindex="-1"></a>      ch <span class="sc">*</span> pr</span>
<span id="cb60-27"><a href="modelling-historical-climate-over-the-study-area.html#cb60-27" tabindex="-1"></a>    }</span>
<span id="cb60-28"><a href="modelling-historical-climate-over-the-study-area.html#cb60-28" tabindex="-1"></a>  )</span>
<span id="cb60-29"><a href="modelling-historical-climate-over-the-study-area.html#cb60-29" tabindex="-1"></a>)</span>
<span id="cb60-30"><a href="modelling-historical-climate-over-the-study-area.html#cb60-30" tabindex="-1"></a></span>
<span id="cb60-31"><a href="modelling-historical-climate-over-the-study-area.html#cb60-31" tabindex="-1"></a><span class="co"># Assign names to corrected rasters</span></span>
<span id="cb60-32"><a href="modelling-historical-climate-over-the-study-area.html#cb60-32" tabindex="-1"></a>data_pred <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb60-33"><a href="modelling-historical-climate-over-the-study-area.html#cb60-33" tabindex="-1"></a>  data_pred,</span>
<span id="cb60-34"><a href="modelling-historical-climate-over-the-study-area.html#cb60-34" tabindex="-1"></a>  <span class="at">names =</span> <span class="fu">glue</span>(<span class="st">&quot;{climvar}_{year_bin}_{season}&quot;</span>)</span>
<span id="cb60-35"><a href="modelling-historical-climate-over-the-study-area.html#cb60-35" tabindex="-1"></a>)</span>
<span id="cb60-36"><a href="modelling-historical-climate-over-the-study-area.html#cb60-36" tabindex="-1"></a></span>
<span id="cb60-37"><a href="modelling-historical-climate-over-the-study-area.html#cb60-37" tabindex="-1"></a><span class="fu">names</span>(data_pred<span class="sc">$</span>corrected) <span class="ot">&lt;-</span> data_pred<span class="sc">$</span>names</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="modelling-historical-climate-over-the-study-area.html#cb61-1" tabindex="-1"></a><span class="co"># Collect the predictions for each season and climate variable</span></span>
<span id="cb61-2"><a href="modelling-historical-climate-over-the-study-area.html#cb61-2" tabindex="-1"></a><span class="co"># into one raster stack each</span></span>
<span id="cb61-3"><a href="modelling-historical-climate-over-the-study-area.html#cb61-3" tabindex="-1"></a><span class="co"># Each stack has multiple layers, each representing one 30-year bin</span></span>
<span id="cb61-4"><a href="modelling-historical-climate-over-the-study-area.html#cb61-4" tabindex="-1"></a>data_reconstructed <span class="ot">&lt;-</span> data_pred <span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="modelling-historical-climate-over-the-study-area.html#cb61-5" tabindex="-1"></a>  <span class="fu">group_by</span>(</span>
<span id="cb61-6"><a href="modelling-historical-climate-over-the-study-area.html#cb61-6" tabindex="-1"></a>    season, climvar</span>
<span id="cb61-7"><a href="modelling-historical-climate-over-the-study-area.html#cb61-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb61-8"><a href="modelling-historical-climate-over-the-study-area.html#cb61-8" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb61-9"><a href="modelling-historical-climate-over-the-study-area.html#cb61-9" tabindex="-1"></a>    <span class="at">corrected =</span> <span class="fu">list</span>(<span class="fu">Reduce</span>(corrected, <span class="at">f =</span> c))</span>
<span id="cb61-10"><a href="modelling-historical-climate-over-the-study-area.html#cb61-10" tabindex="-1"></a>  )</span>
<span id="cb61-11"><a href="modelling-historical-climate-over-the-study-area.html#cb61-11" tabindex="-1"></a></span>
<span id="cb61-12"><a href="modelling-historical-climate-over-the-study-area.html#cb61-12" tabindex="-1"></a><span class="co"># Save each raster stack as a TIF file</span></span>
<span id="cb61-13"><a href="modelling-historical-climate-over-the-study-area.html#cb61-13" tabindex="-1"></a><span class="fu">pwalk</span>(</span>
<span id="cb61-14"><a href="modelling-historical-climate-over-the-study-area.html#cb61-14" tabindex="-1"></a>  data_reconstructed,</span>
<span id="cb61-15"><a href="modelling-historical-climate-over-the-study-area.html#cb61-15" tabindex="-1"></a>  <span class="cf">function</span>(season, climvar, corrected) {</span>
<span id="cb61-16"><a href="modelling-historical-climate-over-the-study-area.html#cb61-16" tabindex="-1"></a>    <span class="fu">names</span>(corrected) <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">&quot;{climvar}_{season}_{seq(1870, 2018, 10)}&quot;</span>)</span>
<span id="cb61-17"><a href="modelling-historical-climate-over-the-study-area.html#cb61-17" tabindex="-1"></a></span>
<span id="cb61-18"><a href="modelling-historical-climate-over-the-study-area.html#cb61-18" tabindex="-1"></a>    terra<span class="sc">::</span><span class="fu">writeRaster</span>(</span>
<span id="cb61-19"><a href="modelling-historical-climate-over-the-study-area.html#cb61-19" tabindex="-1"></a>      corrected,</span>
<span id="cb61-20"><a href="modelling-historical-climate-over-the-study-area.html#cb61-20" tabindex="-1"></a>      <span class="fu">glue</span>(<span class="st">&quot;results/climate/raster_reconstructed_{climvar}_{season}.tif&quot;</span>)</span>
<span id="cb61-21"><a href="modelling-historical-climate-over-the-study-area.html#cb61-21" tabindex="-1"></a>    )</span>
<span id="cb61-22"><a href="modelling-historical-climate-over-the-study-area.html#cb61-22" tabindex="-1"></a>  }</span>
<span id="cb61-23"><a href="modelling-historical-climate-over-the-study-area.html#cb61-23" tabindex="-1"></a>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="building-a-correction-layer-for-climate-predictions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analyzing-temperature-and-precipitation-change-over-time.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/vjjan91/nilgiris-resurvey-project/edit/master/04_climate-reconstruction.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
